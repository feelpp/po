\documentclass[12pt]{article}
\usepackage{fontspec}
\usepackage[colorlinks]{hyperref}
\usepackage{libertine}
\usepackage{stmaryrd}
\usepackage{amsmath,amsthm,amssymb}
\usepackage[french]{babel}
\usepackage{geometry}
\usepackage{xspace}
\newcommand{\curlk}[1][k]{\ensuremath{\nabla^{#1}\hspace{-.3em}\times}\xspace}

\title{NS$^2_{++}$: Non Standard Navier-Stokes equations for large scale
computational fluid dynamics in Feel++.}

\author{P. Gilotte\thanks{Plastic Omnium Auto Exterior Services - SIGMATECH}
\and Benjamin Surowiec\footnotemark[1] \and C. Prud'homme\thanks{Cemosis, Irma,
U. Strasbourg -- Centre de Modélisation et Simulation de Strasbourg -
\url{http://www.cemosis.fr}} }

\begin{document}

\maketitle

\abstract{Dans ce projet, on cherche à mettre en place les briques nécessaires à
une stratégie non-standard de résolution des équations de Navier-Stokes
incompressibles qui permettrait à PlasticOmnium (PO) d'augmenter le temps
d'étude des écoulements de 1s actuellement à 10s avec un budget identique sur
des grilles de l'ordre de 100 millions de mailles. L'objectif à la fin du projet
étant d'avoir \textit{(i)} développé le cadre numérique, \textit{(ii)} développé
les briques logicielles en Feel++ nécessaires et \textit{(iii)} testé sur
quelques benchmarks de PO. }

\section{Description}
\label{sec:description}

Les pertes dans le sillage d’un véhicule contribuent, dans le cas d’un véhicule
break, à la moitié des pertes totales d’énergie sur un trajet
autoroutier. Cependant la réduction des pertes dans cette zone instationnaire
nécessite des études numériques modélisant les plus grandes structures
tourbillonnaires de l’écoulement. Grâce aux performances des serveurs de calcul,
il est maintenant possible d’utiliser des modèles numériques tels que les
modèles LES, permettant de résoudre les phénomènes instationnaires aux grandes
échelles de la turbulence. Il nécessite cependant des temps de calcul et de
stockage importants.

Une alternative à cette méthode serait de définir la base des vecteurs propres
de la vorticité, dépendant uniquement de la géométrie et sur laquelle serait
projeté le champ de vitesse, pour résoudre les équations de Navier-Stokes. Seuls
les coefficients associés aux vecteurs propres seraient à calculer à chaque pas
de temps, ce qui permettrait de réduire fortement les temps de calcul. Cette
méthode se fonde sur les travaux mathématiques du professeur Penel de
l’université de Toulon, réalisé en collaboration avec le Prof Neustupa de la
faculté de mathématique de Prague~\cite{Penel2004}. Elle suppose de résoudre le
champ de vitesse d’écoulements incompressibles sur la base de vecteurs
propres de la vorticité avec des conditions d’imperméabilité sur la vitesse et
la vorticité, dans un espace à divergence nulle. La mise en équation réalisée
avec le Prof. Penel a été testée par un doctorant à Plastic Omnium avec le
logiciel Freefem++, mais le nombre de modes à résoudre et la taille des matrices
demandent une décomposition et une résolution sur plusieurs processeurs avec des
algorithmes itératifs disponibles uniquement dans Feel++.

Feel++\footnote{\url{http://www.feelpp.org}, \url{https://github.com/feelpp/feelpp}} (Finite Element Embedded Library in
C++, \cite{prud2012feel++,feelpp098:10046} ) est une librairie C++ sous licence
libre (LGPL), dont le responsable est C. Prud'homme, permettant la résolution
d'une très large gamme d'équations aux dérivées partielles par des méthodes de
Galerkin continue et discontinue en 1D, 2D et 3D. Elle permet d'écrire via un
language permettant de manipuler les formulations variationnelles ainsi que les
objets afférents (mailage, espaces de functions, matrices, vecteurs...) de
manière très proche des mathématiques. Cette librairie offre un parallélisme
transparent et a déjà été utilisé pour des simulations sur plusieurs miliers de
coeurs de calcul avec les bonnes propriétés de scalabilité. Enfin Feel++
s'appuie sur PETSc pour les structures matrices/vecteurs, solveurs linéaires et
non-linéaires ainsi que préconditionneurs et SLEPc pour les solveurs de
problèmes aux valeurs propres standards et généralisés (qui s'appuie sur PETSc).

Dans notre cas, le problème aux valeurs propres est celui de l'opérateur rotationnel
associé à des conditions aux limites homogènes d'imperméabilité généralisée introduite
par P.Penel et J. Neustupa\cite{Penel2004}: soit
$\Omega \subset \mathbb{R}^3$, trouver $(\mathbf{g},\lambda)$ tels que
\footnote{L'équation (1) implique directement l'équation (2)}
\footnote{Les fonctions propres des opérateurs $\nabla \times$ et $\nabla^2 \times$
sont identiques}
%\footnote{L'utilisation des éléments de Nedelec pour la résolution du problème nous éviterait d'imposer par des méthodes de pénalisation l'équation (2) et les
%conditions aux limites (3a) et (3b)}
\begin{align}
\label{eq:0}
\nabla^2 \times \mathbf{g} &= \lambda \mathbf{g},\quad \mbox{ dans } \Omega\\
(\nabla \cdot \mathbf{g} &= 0,\quad \mbox{ dans } \Omega )\\
\curlk{} \mathbf{g} \cdot \mathbf{n} &= 0,\, k=0,1,2,\quad \mbox{ sur
} \partial \Omega
\end{align}
où $\mathbf{g}$ et $\lambda$ sont respectivement les fonctions propres et les
 vecteurs propres de l'opérateur $\nabla^2 \times$ et avec la convention
$\curlk[0]{} = Id$.


Concernant le dernier point, au coeur de la nouvelle stratégie un grand nombre
de modes propres sont à calculer pour le problème de Navier-Stokes à faible
Reynolds un premier temps: soit $\Omega
\subset \mathbb{R}^3$, trouver $(\mathbf{u},p)$ tels que
\begin{align}
  \label{eq:1}
  - \nu \Delta \mathbf{u} + (\mathbf{u} \cdot \nabla)\mathbf{u} + \nabla p &= \mathbf{f},\quad \mbox{ dans } \Omega\\
  \nabla \cdot \mathbf{u} &= 0,\quad \mbox{ dans } \Omega\\
  \curlk{} \mathbf{u} \cdot \mathbf{n} &= 0,\, k=0,1,2,\quad \mbox{ sur
  } \partial \Omega
\end{align}
où $\mathbf{u}$ et $p$ sont respectivement la vitesse et la pression,
$\mathbf{n}$ la normale exterieure à $\partial \Omega$ et avec la convention
$\curlk[0]{} = Id$. Ce type de problème de Stokes a été étudié par
V. Girault~\cite{girault90-1} mais cette formulation n'est pas ou peu
utilisée. Il est d'abord nécessaire de l'étudier et de proposer un cadre discret
propre pour sa résolution. Un autre aspect délicat est la résolution d'un grand
nombre de modes propres sur des grilles avec un très grand nombre de mailles en
3D, l'objectif est de pouvoir résoudre ces problèmes sur des grilles jusqu'à
environ 100 millions de mailles.  Le travail a donc deux composantes :
\textit{(i)} l'étude mathématique et numérique et l'implémentation efficace de
la formulation ci-dessus, \textit{(ii)} le passage à l'échelle de la nouvelle
stratégie, et en particulier des problèmes aux valeurs propres, sur des grilles
de très grande taille.



Un stagiaire en Master à l’université de Strasbourg a  repris ces travaux au
premier semestre 2014, pour retrouver avec Feel++ les résultats de l’écoulement
de Stokes dans un conduit cylindrique, obtenus précédemment avec Freefem++.

La collaboration entre le laboratoire IRMA et Plastic Omnium a permis au cours
de ce stage d’identifier les développements à réaliser sur Feel++ pour apporter
plus de robustesse à la méthode de résolution. Il serait nécessaire d’intégrer
de nouvelles fonctions tests dans l’espace mathématique nouvellement défini et
des routines permettant de résoudre l’opérateur de vorticité, associé aux
nouvelles conditions d’imperméabilité généralisées. Ce sont ces deux
développements, qui seraient à réaliser pendant les six premiers mois du projet
PEPS, avant de tester le résultat de ce développement sur des modèles numériques
différents de celui du cylindre. La première partie de développement aurait lieu
à Strasbourg et la deuxième phase plus applicative pourrait être localisée à
Plastic Omnium. Le cas d’application pourrait être celui d’un écoulement
derrière une marche, résolu à faible puis à haut nombre de Reynolds. Les
résultats à haut nombre de Reynolds pourraient être comparés à des résultats de
calculs à lancer avec un modèle LES, disponibles à Plastic Omnium, ainsi qu’à des
résultats d’essais connus. Cet objectif a pour but de définir le nombre de mode
de la vorticité à prendre en compte, de comparer les temps de calcul et la
précision des résultats à ceux obtenus avec le modèle LES disponible. En cas de
succès, cette méthode permettrait d’augmenter le nombre de pas de temps calculés
et de  réaliser des études spectrales sur un nombre d’échantillons important,
permettant d’analyser par exemple les phénomènes fréquentiels dans les couches
de cisaillement, à l’origine des pertes dans le sillage.



\section{Ressource et budget du projet}
\label{sec:budget}

\subsection{Déroulement du projet}
\label{sec:dero-du-proj}

La personne recrutée sur le projet sera pendant 7 à 8 mois à Strasbourg au
laboratoire IRMA, et en particulier à Cemosis, pour la mise en place des outils
mathématiques et des briques informatiques avec quelques missions à PO. Puis les
4 à 5 derniers mois il sera à PO pour effectuer des benchmarks sur des
géométries propriétaires avec quelques missions à Strasbourg de mise au point.

Cemosis\footnote{\url{http://www.cemosis.fr}} est le Centre de Modélisation et
Simulation de Strasbourg dont l'objectif est la promition et le soutien aux
projets multidisciplinaires et les projects avec les entreprises en modélisation
et simulation en région Alsace. Cemosis s'appuie actuellement sur l'équipe
modélisation et contrôle de l'IRMA et le mésocentre de Strasbourg. Deux
ingénieurs de recherche y sont actuellement dédiés et travaillents sur des
projets collaboratifs avec d'autres disciplines (bio-médical et ingénierie) et
avec des entreprises.

Du point de vue logiciel, le principe général qui guide la collaboration est de
contribuer aux changements génériques nécessaires (calcul haute performance,
maillage, solveurs, ...) du noyau de calcul Feel++ sous licence libre. Par
contre les développements spécifiques pour le projet resteront privés.

\subsection{Ressources existentes}

Pour ce projet, Plastic Omnium propose en terme de ressource de dédier 30\%
de temps ingénieur au projet pour orienter et guider les développements sous
Feel++, pour réaliser les calculs sur un solveur LES et pour analyser les
résultats obtenus. Les calculs pourront être réalisés à PO sur un serveur
disposant de 48 processeurs. Un bureau et un accès au serveur sera disponible à
plastic Omnium pour la personne chargée du développement. Le cout de ce projet
amont pour Plastic Omnium peut être évalué à 40 k€.

En ce qui concerne Cemosis (IRMA), 2 ingénieurs pourront contribuer aux
développements dans le cadre du projet( 5\% de leur temps chacun) ainsi que 10\%
du temps de recherche de C. Prud'homme. Le projet aura accès aux ressources
locales de calcul (irma-atlas 64 coeurs et 0.5 To de memoire) ainsi que le
mésocentre de Strasbourg qui fait partie de l'équipex equip@meso permettant de
donner accès à des ressources de calcul aux collaborations avec les entreprises.

\subsection{Demande}


Dans le cadre du projet, nous demandons la subvention suivante:
\begin{itemize}
\item Personnel: embauche pour un an d'un ingénieur, 37123 Euros
\item Missions : 5000 Euros
\item Fonctionnement  : 4800 Euros
\item Sous traitance en valorisation et propriété intellectuelle : 3000 Euros.
\end{itemize}
Soit un total de \textbf{49923} Euros.

Concernant le poste d'ingénieur, nous aimerions recruter Romain Hild qui
obtiendra son master de mathématiques appliquées (Calcul Scientifique et
Mathématiques de l'Information) de Strasbourg en aout 2014. Le salaire est calé
sur les grilles en vigueur au CNRS. Une perspective est de pouvoir recruté Mr
Hild à la suite de ce travail sur une thèse Cifre.

Les missions concernent le bon fonctionnement du projet avec l'intervention des
ingénieurs de Cemosis pour la mise en place des outils à PO ainsi que les
séances de travail communes entre les deux centres. On y adjoint également la
participation à 2 conférences nationales et 1 internationale.

Concernant le fonctionnement, le projet se servira abondamment d'un cluster de
calcul (irma-atlas), les 5000 Euros sont une contribution à la maintenance et
mise à jour de la machine, aux stockages des données du projet et aux licences
logicels (Ensight 10 et DDT/MAP qui sont des logiciels commerciaux).

Concernant la sous-traitance, la SATT Conectus accompagnera le projet pour les
aspects de valorisation et de mise en place contractuelle entre l'Université de
Strasbourg et PlasticOmnium et ainsi que sur les aspects de propriétés
intellectuelles et sur les aspects logiciels.

\bibliographystyle{plain}
\bibliography{../report/ref}

\end{document}
