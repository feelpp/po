\part{Problem}
\label{partProb}
Let $\Omega\subset\R^3$ be a bounded simply-connected domain with a
Lipschitz continuous boundary $\Gamma$. Let $\Gamma_0,\dots,\Gamma_I$
be the connected components of $\Gamma$.\\

We will use the following notations :
\begin{align*}
gradient(v)&=(\partial_x v, \partial_y v, \partial_z v)=\grad v\\
gradient(\mbf{v})&=\begin{pmatrix}
\partial_x v_x & \partial_y v_x & \partial_z v_x\\
\partial_x v_y & \partial_y v_y & \partial_z v_y\\
\partial_x v_z & \partial_y v_z & \partial_z v_z
\end{pmatrix}=\grad\mbf{v}\\
divergence(\mbf{v})&=\frac{\partial v_x}{\partial x}+\frac{\partial v_y}{\partial y}+\frac{\partial v_z}{\partial z}=\div \mbf{v}\\
curl(\mbf{v})&=\begin{pmatrix}
\partial_y v_z - \partial_z v_y\\
\partial_z v_x - \partial_x v_z\\
\partial_x v_y - \partial_y v_x
\end{pmatrix}=\curl \mbf{v}\\
curl(curl(\mbf{v}))&=\curll \mbf{v}\\
H^1(\Omega) &= \{v \in L^2(\Omega)\;|\; \grad v\in L^2(\Omega)\}\\
H^1_0(\Omega) &= \{v \in H^1(\Omega)\; |\; v\restr{\Gamma} = 0\}\\
H(\mathrm{div};\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \div\mbf{v} \in L^2(\Omega) \}\\
H(\mathrm{curl};\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \curl\mbf{v} \in L^2(\Omega) \}\\
L^2_\sigma(\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \div \mbf{v} = 0\text{ et }\mbf{v}\cdot \mbf{n}\restr{\Gamma} = 0 \}\\
D^1(\Omega) &= \{\mbf{v} \in [H^1(\Omega)]^3\cap L^2_\sigma(\Omega)\; |\; (\curl \mbf{v}\cdot \mbf{n})\restr{\Gamma} = 0  \}
\end{align*}

Nous cherchons $(\mathbf{v},p)$, correspondant respectivement à la vitesse et à la pression, solutions de l'équation de Navier-Stokes incompressibles adimensionnalisées dans $Q_T=\Omega\times[0,T]$, où $\Omega$ est un ouvert de $\R^3$ et $\partial\Omega$ sa frontière, avec une condition initiale et des conditions aux limites d'imperméabilité généralisée.
\begin{pb}\label{depart}
On cherche $(\mathbf{v},p)$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&\frac{\partial \mathbf{v}}{\partial t} + (\curl  \mathbf{v})\times \mathbf{v} + \grad q + \frac{1}{Re}\curll  \mathbf{v}-\mathbf{f} = 0\\
&\div \mathbf{v} = 0\\
&\mathbf{v}\big\rvert_{t=0} = \mathbf{v}_0\\
&\mathbf{v}\cdot \mathbf{n}\restr{\Gamma} = \alpha_0\\
&(\curl  \mathbf{v})\cdot \mathbf{n}\restr{\Gamma} = \alpha_1\\
&(\curll  \mathbf{v})\cdot \mathbf{n}\restr{\Gamma} = \alpha_2
\end{aligned}\right.
\end{equation*}
où $q = \frac{|\mathbf{v}|^2}{2}+p$.\\
\end{pb}
Ce problème possède des conditions aux bords non standards, plutôt que des conditions de Dirichlet, on utilise les conditions $\nabla^k\times\mathbf{v}\cdot\mathbf{n}\restr{\Gamma}$ pour $k=0,1,2$ avec la convention $\nabla^0\times=Id$.\\
Ces conditions ont été assez peu étudiées et très peu utilisées dans l'industrie. On peut citer les travaux de V. Girault \cite{girault90-1}, H. Bellout, J. Neustuppa et P. Penel \cite{Penel2004}. Le principe est une décomposition de type Galerkin que l'on peut rapprocher avec les travaux de E. Deriaz et V. Perrier \cite{Deriaz2009249}.\\

L'intérêt pour Plastic Omnium est de pouvoir séparer les variables en temps et en espace et ainsi pouvoir faire des simulations sur un laps de temps plus long. De plus, les lois de paroi n'étant plus nécessaires, on supprime le besoin de prendre en compte la couche limite lors du maillage.\\

On va maintenant expliquer la stratégie de résolution du problème dans le chapitre \ref{strat}, puis étudié plus en détail chaque étapes de la résolution dans \ref{fv}.

\chapter{Stratégie de résolution}
\label{strat}
D'après \cite{Penel2004}, l'existence et l'unicité de la solution sont assurés si la solution est dans $D^1$, c'est-à-dire $\nabla^k\times\mathbf{v}\cdot\mathbf{n}\restr{\Gamma}=0$ pour $k=0,1$. On va donc relever ces conditions aux bords à l'aide d'une fonction $\mathbf{a}$. On cherche à écrire  $\mathbf{v}=\mathbf{u}+\mathbf{a}$, tel que :\\
\begin{equation}\label{v}
\begin{array}{c|ccccc}
& \mathbf{v} & = & \mathbf{a} & + & \mathbf{u}\\ \hline
\div\star & 0 & & 0 & & 0\\ \hline
\star\cdot \mathbf{n}\restr{\Gamma} & \alpha_0 & & \alpha_0 & & 0\\ \hline
\curl\star\cdot \mathbf{n}\restr{\Gamma} & \alpha_1 & & \alpha_1 & & 0\\ \hline
\curll\star\cdot \mathbf{n}\restr{\Gamma} & \alpha_1 & & 0 & & \alpha_2
\end{array}
\end{equation}
Ainsi, on a $\mathbf{u}\in D^1(\Omega)$ qui sert à définir la solution à l'intérieur du domaine et $\mathbf{a}\in [L^2(\Omega)]^3$ qui sert à relever le problème sur les bords du domaine.
\begin{pb}\label{a}
Trouver $\mathbf{a}\in [L^2(\Omega)]^3$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&\mathbf{a}=\curl \mathbf{b}+\grad\psi^0\\
&\div \mathbf{a} =0\\
&\mathbf{a}\cdot \mathbf{n}\restr{\Gamma} = \alpha_0\\
&(\curl \mathbf{a})\cdot \mathbf{n}\restr{\Gamma} = \alpha_1
\end{aligned}\right.
\end{equation*}
\end{pb}
En appliquant la divergence et les conditions aux bords à la première ligne du problème on obtient le tableau suivant :
\begin{center}
\begin{tabular}{c|ccccc}
& $\mathbf{a}$ & = & $\grad\psi^0$ & + & $\curl \mathbf{b}$ \\ \hline
$\div\star$ & 0 & & $\laplace\psi^0$ & & 0\\ \hline
$\star\cdot \mathbf{n}\restr{\Gamma}$ & $\alpha_0$ & & $\alpha_0$ & & 0\\ \hline
$\curl\star\cdot \mathbf{n}\restr{\Gamma}$ & $\alpha_1$ & & 0 & & $\alpha_1$
\end{tabular}
\end{center}
En utilisant la première et la deuxième ligne du tableau, on obtient le problème :
\begin{pb}\label{psi0}
Trouver $\psi^0$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&-\laplace\psi^0 = 0\\
&\grad\psi^0\cdot \mathbf{n}\restr{\Gamma}=\alpha_0
\end{aligned}\right.
\end{equation*}\end{pb}
Ce problème permet de trouver $\psi^0$ à une constante près, on va donc utiliser un multiplicateur de Lagrange pour ajouter une contrainte sur $\psi^0$, par exemple $\int_\Omega \psi^0 = 0$, cette constante est sans importance car on cherche le gradient de $\psi^0$.\\
Il y a plusieurs manières de résoudre le problème \ref{psi0}, la solution choisie sera discutée plus loin.\\

Soit $\mathbf{b}$ solution du problème mixte suivant
\begin{pb}\label{curlb}
Trouver $(\mathbf{b},\psi^1)$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&\curll \mathbf{b} = \grad\psi^1\\
&\div \mathbf{b} = 0\\
&\mathbf{b}\cdot \mathbf{n}\restr{\Gamma} = 0\\
&\curl \mathbf{b}\cdot \mathbf{n}\restr{\Gamma} = 0\\
&\grad\psi^1\cdot \mathbf{n}\restr{\Gamma} = \alpha_1
\end{aligned}\right.
\end{equation*}\end{pb}

% Il reste encore plusieurs questions concernant la manière de relever $\alpha_1$. En effet, écris de cette manière, $\mathbf{b}\in D^1(\Omega)$ et donc si $\mathbf{b}\cdot\mathbf{n}\restr{\Gamma}=0$ alors $\curll\mathbf{b}\cdot\mathbf{n}\restr{\Gamma}=0$ aussi. Ce problème est donc encore ouvert.\\

Une fois $\grad\psi^0$, $\curl \mathbf{b}$ connus, on peut retrouver $\mathbf{a}$.\\

On remplace maintenant $\mathbf{v}$ par $\mathbf{u}+\mathbf{a}$ dans le problème \ref{depart} :
\[ \frac{\partial(\mathbf{u}+\mathbf{a})}{\partial t}+(\curl(\mathbf{u}+\mathbf{a}))\times(\mathbf{u}+\mathbf{a}) + \grad (\frac{|\mathbf{u}+\mathbf{a}|^2}{2}+p) + \frac{1}{Re}\curll(\mathbf{u}+\mathbf{a}) - \mathbf{f} = 0 \]
Ce qui donne en notant $\pi_a=\frac{|\mathbf{u}+\mathbf{a}|^2}{2}+p$ :
\[ \frac{\partial \mathbf{u}}{\partial t}+\frac{\partial \mathbf{a}}{\partial t} + (\curl \mathbf{u}+\curl \mathbf{a})\times(\mathbf{u}+\mathbf{a}) + \grad\pi_{\mathbf{a}} + \frac{1}{Re}(\curll \mathbf{u}+\curll \mathbf{a}) - \mathbf{f} = 0 \]
Comme $\curll \mathbf{a} = 0$ et en notant $\mathbf{f_a}=\mathbf{f}-\frac{\partial \mathbf{a}}{\partial t} - (\curl \mathbf{a})\times \mathbf{a}$, on a le problème suivant :
\begin{pb}\label{pbu}
Trouver $\mathbf{u}$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&\frac{\partial \mathbf{u}}{\partial t} + (\curl \mathbf{u})\times \mathbf{u} + (\curl \mathbf{u})\times \mathbf{a} +(\curl \mathbf{a})\times \mathbf{u} + \grad \pi_{\mathbf{a}} +\frac{1}{Re}\curll  \mathbf{u} - \mathbf{f_a} = 0\\
&\div \mathbf{u} = 0\\
&\mathbf{u}\big\rvert_{t=0} = \mathbf{v}_0 - \mathbf{a}(0,\cdot)\\
&\mathbf{u}\cdot \mathbf{n}\restr{\Gamma} = 0\\
&(\curl \mathbf{u})\cdot \mathbf{n}\restr{\Gamma} = 0\\
&(\curll  \mathbf{u})\cdot \mathbf{n}\restr{\Gamma} = \alpha_2
\end{aligned}\right.
\end{equation*}\end{pb}

On cherche donc $\mathbf{u}=\mathbf{v}-\mathbf{a}$, et en utilisant une décomposition de Galerkin, on a :
\begin{equation}\label{u}
\mathbf{u}(t,\cdot) = \sum_{i=1}^{\infty} c_i(t)\mathbf{g}_i(\cdot)
\end{equation}
où on sépare les variables en temps et en espace. Les coefficients $c_i$ contiennent toutes les informations dépendantes du temps, tandis que les fonctions $\mathbf{g}_i$ portent la composante spatiale.\\

Comme $\mathbf{u}\in D^1(\Omega)=D(\mathrm{rot}_{imperm})$, d'après \cite{Penel2004}, on peut choisir les fonctions de base
$\mathbf{g}_i$ comme étant les fonctions propres de l'opérateur rotationnel. Ces
fonctions sont les mêmes que celles de l'opérateur $\curll$.

En effet, soit $(\lambda_i,\mathbf{g}_i)$ solutions de $\curl \mathbf{g}_i = \lambda_i\mathbf{g}_i$ et $(\Lambda_i,\mathbf{G}_i)$ solutions de $\curll \mathbf{G}_i = \Lambda_i\mathbf{G_i}$. Alors :
\[ \curll \mathbf{g}_i = \curl(\curl \mathbf{g}_i)=\curl(\lambda_i\mathbf{g}_i)=\lambda^2\mathbf{g}_i \]
Par identification, on voit que $\mathbf{g}_i=\mathbf{i}_i$ et que $\lambda_i=\pm\sqrt\Lambda_i$. Pour n'avoir que des valeurs propres de multiplicité une, on ne garde que les valeurs propres positives, le signe étant porté par le coefficient $c_i$.

On cherche donc à résoudre le problème aux valeurs propres suivant :
\begin{pb}\label{curlcurl}
Trouver$(\lambda_i,\mathbf{g}_i)\in\R\times D^1(\Omega)$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&\curll  \mathbf{g}_i = \lambda_i^2 \mathbf{g}_i\\
&\mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0\\
&\curl \mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0\\
&\curll  \mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0
\end{aligned}\right.
\end{equation*}\end{pb}

En injectant (\ref{u}) dans le problème \ref{pbu}, on obtient :
\begin{align*}
\frac{\partial}{\partial t}\left(\sum_{i=1}^\infty c_i\mathbf{g}_i\right) &+ \left(\curl \left(\sum_{i=1}^\infty c_i\mathbf{g}_i\right)\right)\times \left(\sum_{i=1}^\infty c_i\mathbf{g}_i\right) + \left(\curl \left(\sum_{i=1}^\infty c_i\mathbf{g}_i\right)\right)\times \mathbf{a}&\\
&+ (\curl \mathbf{a})\times \left(\sum_{i=1}^\infty c_i\mathbf{g}_i\right) + \grad \pi_{\mathbf{a}} +\frac{1}{Re}\curll  \left(\sum_{i=1}^\infty c_i\mathbf{g}_i\right) - \mathbf{f_a} =0\\
\end{align*}

En utilisant la linéarité de la dérivée, ainsi que celle de l'opérateur rotationnel et le fait que les fonctions $\bm{g_i}$ soient les modes propres de cet opérateur, on obtient le problème suivant :
\begin{pb}\label{pbc}
Trouver $(c_i)$ tel que :
\begin{align*}
\sum_{i=1}^\infty\frac{\partial c_i}{\partial t}\mathbf{g}_i &+ \sum_{i=1}^\infty\sum_{j=1}^\infty c_i\lambda_ic_j(\mathbf{g}_i\times \mathbf{g}_j) + \sum_{i=1}^\infty c_i\lambda_i(\mathbf{g}_i\times \mathbf{a})\\
& + \sum_{i=1}^\infty c_i((\curl\mathbf{a})\times \mathbf{g}_i) + \grad \pi_{\mathbf{a}} +\frac{1}{Re}\sum_{i=1}^\infty c_i\lambda_i^2\mathbf{g}_i - \mathbf{f_a} = 0\\
\end{align*}
avec \[ \sum_{i=1}^\infty c_i(0)\mathbf{g}_i = \mathbf{v_0}-\mathbf{a}(0,\cdot) \]
\end{pb}

%% Comme les conditions aux bords sont respectées par tous les $\mathbf{g}_i$, $\mathbf{u}$, en tant que combinaison linéaire de ceux-ci, les respectent aussi.\\

Pour résumer, on doit donc :
\begin{enumerate}
\item générer la base $\mathbf{g}_i$ des fonctions propres de l'opérateur curl en résolvant le problème aux valeurs propres \ref{curlcurl} comme expliqué dans le chapitre \ref{eigen}.
\item trouver $\mathbf{a}$ pour pouvoir décomposer $\mathbf{v}$ en $\mathbf{u}+\mathbf{a}$, pour cela, on résout les problèmes \ref{psi0} et \ref{curlb}. Ce qui permet de trouver $\mathbf{a}$ grâce au problème \ref{a}. Cette partie est détaillé dans \ref{relev}.
\item résoudre le problème \ref{pbc} pour trouver les coefficients $c_i$. Cela est expliqué dans \ref{spectre}.
\item recomposer $\mathbf{v}=\mathbf{u}+\mathbf{a}$, et chercher $p$ pour avoir la solution du problème \ref{depart}. Cette dernière partie est montré dans \ref{pression}.
\end{enumerate}
Cette stratégie est présenté dans la figure \ref{org1}.
\begin{figure}[H]
\centering
\begin{tikzpicture}
\node[draw,scale=\taille,fill=green!50] (alpha0) at (0,10) {$\alpha_0$};
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.9cm]\ref{psi0}}] (pbpsi0) at (0,8) {$\begin{aligned}
-\laplace\psi^0&=0\\
\grad\psi^0\cdot \mathbf{n} &= \alpha_0 \end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (gradpsi0) at (0,5.5) {$\grad\psi^0$} ;
\node[draw,scale=\taille,fill=green!50] (alpha1) at (3,10) {$\alpha_1$};
\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.1cm]\ref{curlb}}] (pbcurlb) at (3,8) {$\begin{aligned}\curll \mathbf{b} = \grad\psi^1\\
\div \mathbf{b} = 0\\
\mathbf{b}\cdot \mathbf{n}\restr{\Gamma} = 0\\
\curl \mathbf{b}\cdot \mathbf{n}\restr{\Gamma} = 0\\
\grad\psi^1\cdot \mathbf{n}\restr{\Gamma} = \alpha_1 \end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (curlb) at (3,5.5) {$(\curl\mathbf{b},\grad\psi^1)$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.1cm]\ref{a}}] (pba) at (1.5,4) {$\mathbf{a}=\grad\psi^0+\curl\mathbf{b}$};
\node[draw,scale=\taillem,fill=blue!50] (a) at (1.5,3) {$\mathbf{a}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.3cm]\ref{curlcurl}}] (pbeigen) at (10,8) {$\begin{aligned}
\curll \mathbf{g}_i = \lambda_i^2\mathbf{g}_i\\
\div\mathbf{g}_i = 0\\
\mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0\\
\curl \mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0\\
(\curll \mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0) \end{aligned}$} ;
\node[draw,scale=\taille,fill=yellow!50] (lambdagi) at (10, 5.5) {$(\lambda_i,\mathbf{g}_i)$} ;
\node[draw,scale=\taille,fill=green!50] (alpha2) at (5.75,5.5) {$\alpha_2$};
\node[draw,scale=\taille,fill=green!50] (f) at (6.75,5.5) {$\mathbf{f}$};
\node[draw,scale=\taille,fill=green!50] (c0) at (7.75,5.5) {$c_i(0)$};
\node[draw,scale=\taille,fill=gray!50,label={[xshift=4.2cm]\ref{pbc}}] (pbc) at (8.5,3) {$\begin{aligned}
\sum_{i=1}^\infty\frac{\partial c_i}{\partial t}\bm{g_i} &+ \sum_{i=1}^\infty\sum_{j=1}^\infty c_i\lambda_ic_j(\bm{g_i}\times \bm{g_j}) + \sum_{i=1}^\infty c_i\lambda_i(\bm{g_i}\times \mathbf{a})\\
& + \sum_{i=1}^\infty c_i((\curl\mathbf{a})\times \mathbf{g}_i) + \grad \pi_{\mathbf{a}} +\frac{1}{Re}\sum_{i=1}^\infty c_i\lambda_i^2\mathbf{g}_i - \mathbf{h_a} = 0 \end{aligned}$};
\node[draw,scale=\taillem,fill=blue!50] (u) at (8.5,1) {$\mathbf{u}$} ;
\node[draw,scale=\taille,fill=gray!50] (pbv) at (5,-0.5) {$\mathbf{v}=\mathbf{a}+\mathbf{u}$} ;
\node[draw,scale=\tailleg,fill=red!50] (v) at (5,-2) {$(\mathbf{v},p)$} ;

\draw[->,>=latex] (alpha0) -- (pbpsi0); \draw[->,>=latex] (pbpsi0) -- (gradpsi0); \draw[->,>=latex] (alpha1) -- (pbcurlb); \draw[->,>=latex] (pbcurlb) -- (curlb); \draw[->,>=latex] (gradpsi0) -- (pba); \draw[->,>=latex] (curlb) -- (pba); \draw[->,>=latex] (pba) -- (a); \draw[->,>=latex] (pbeigen) -- (lambdagi); \draw[->,>=latex] (a) -- (pbc); \draw[->,>=latex] (alpha2) -- (pbc); \draw[->,>=latex] (f) -- (pbc); \draw[->,>=latex] (c0) -- (pbc); \draw[->,>=latex] (lambdagi) -- (pbc); \draw[->,>=latex] (pbc) -- (u); \draw[->,>=latex] (u) -- (pbv); \draw[->,>=latex] (a) -- (pbv); \draw[->,>=latex] (pbv) -- (v);
\end{tikzpicture}
\caption{Organigramme de la stratégie de résolution}\label{org1}
\end{figure}

\chapter{Formulations variationnelles}
\label{fv}
Maintenant que l'on sait comment nous allons procéder pour résoudre le problème \ref{depart}, on va examiner plus en détail chacun des problèmes le composant, en particulier, on va chercher les formulations variationnelles de chacun.

\input{./tex/problem/mode}

\input{./tex/problem/relev}

\input{./tex/problem/ps}

\input{./tex/problem/press}

\chapter{Récapitulatif}

Les différentes étapes pour résoudre le problème sont donc :
\begin{enumerate}
\item calculer les valeurs et fonctions propres de l'opérateur rotationnel avec le problème \ref{pbweak},
  \todo[inline]{Utiliser des solveurs itératifs}
\item décomposer ces fonctions propres en résolvant \ref{fvgi0} et \ref{fvpsiml},
  \todo[inline]{Peut-être pas nécessaire}
\item trouver $\psi^0$, pour cela, on peut :
  \begin{itemize}
  \item résoudre \ref{fvpsi0} pour avoir $\psi^0\in H^1$,
  \item résoudre \ref{fvpsidiv} pour avoir $\psi^0\in H(\mathrm{div})$,
  \end{itemize}
  \todo[inline]{ok}
\item résoudre \ref{fvbcurl} ou \ref{pbbd1} pour trouver $\curl\mathbf{b}$,
  \todo[inline]{à voir}
\item résoudre un système à déterminer pour trouver $\mathbf{e}$,
  \todo[inline]{à voir}
\item recomposer $\mathbf{a}$ grâce à $\psi^0$ et $\curl\mathbf{b}$,
\item résoudre le problème spectral \ref{fvc} afin de trouver les coefficients $c_i$ pour $i=0\dots M$,
  \todo[inline]{prendre en compte ou pas $\alpha_2$}
\item reconstruire $\mathbf{u}=\sum c_i \mathbf{g}_i$ et $\mathbf{v}=\mathbf{a}+\mathbf{u}$,
\item calculer la pression en post-traitement avec le problème \ref{fvq}.
\end{enumerate}

On a ainsi trouver notre solution $(\mathbf{v},p)$.\\
L'étape une est très coûteuse en temps de calcul, mais elle ne dépend que de la géométrie, ainsi, on peut réutiliser les fonctions propres même si l'on change certains paramètres. On a donc à réaliser cette étape seulement une fois par géométrie.\\
Les autres étapes dépendants de différents paramètres, on devra de nouveau les exécuter si l'on change les paramètres, notamment l'étape 6, qui prend en compte tous les paramètres et qui est elle aussi coûteuse en temps de calcul.\\

La figure \ref{org3} présente graphiquement les problèmes à résoudre.\\

\begin{figure}
\centering
\begin{tikzpicture}[scale=\taille]
\node[draw,scale=\taille,fill=green!50] (di) at (3,8) {Données initiales} ;
\node[draw,scale=\taille,fill=gray!50] (pb) at (3,7) {Problèmes à résoudre} ;
\node[draw,scale=\taille,fill=blue!50] (si) at (3,6) {Solutions intermédiaires} ;
\node[draw,scale=\taille,fill=yellow!50] (sim) at (3,5) {Sol. inter. dépendantes de la géométrie} ;
\node[draw,scale=\taille,fill=red!50] (sf) at (3,4) {Solutions finales} ;
\node[scale=\taille,text width=10cm] (coblig) at (15,8) {Chemins obligatoires} ;
\node[scale=\taille,text width=10cm] (cpurple) at (15,7.5) {{\color{purple} Chemins pour $\psi^0\in H^1$}} ;
\node[scale=\taille,text width=10cm] (cgreen) at (15,7) {{\color{green} Chemins pour $\psi^0\in H(\mathrm{div})$}} ;
\node[scale=\taille,text width=10cm] (cmagenta) at (15,6.5) {{\color{magenta} Chemins pour $\curl \mathbf{b} \in H(\mathrm{rot})$}} ;
\node[scale=\taille,text width=10cm] (ccyan) at (15,6) {{\color{cyan} Chemins pour $\curl \mathbf{b} \in D^1$}} ;
\node[scale=\taille,text width=10cm] (cred) at (15,5.5) {{\color{red} Chemins pour $\psi^1 \in H^1$}} ;
\node[scale=\taille,text width=10cm] (corange) at (15,5) {{\color{orange} Chemins pour $\psi^1 \in H(\mathrm{div})$}} ;

\node[draw,scale=\taille,fill=green!50] (a0) at (0.75,2) {$\alpha_0$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=-0.8cm]\ref{fvpsi0}}] (pbpsi0lp) at (-0.5,-2)
{$\begin{aligned}
-\laplace\psi^0&=0\\
\grad\psi^0\cdot \mathbf{n} &= \alpha_0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (psi0) at (-0.5,-3.5) {$\psi^0$} ;
\node[draw,scale=\taille,fill=gray!50] (pbgradpsi0) at (-0.5,-4.75) {$w=\grad\psi^0$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.8cm]\ref{fvpsidiv}}] (pbpsi0div) at (2,-2)
{$\begin{aligned}
\mathbf{w}&=\grad\psi^0\\
\div\mathbf{w}&=0\\
\mathbf{w}\cdot \mathbf{n} &= \alpha_0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (gradpsi0) at (0.75,-8.75) {$\grad\psi^0$} ;

\node[draw,scale=\taille,fill=green!50] (a1) at (5.5,2) {$\alpha_1$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.0cm]\ref{fvbcurl}}] (pbbcurl) at (4,-5)
{$\begin{aligned}
\curll \mathbf{b} &= \grad\psi^1\\
\div \mathbf{b} &=0\\
\mathbf{b}\cdot \mathbf{n} &= 0\\
\curl \mathbf{b}\cdot \mathbf{n} &= 0\\
\grad \psi^1\cdot \mathbf{n} &= \alpha_1
\end{aligned}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=-0.8cm]\ref{fvpsi0}}] (pbpsi1lp) at (7,-2)
{$\begin{aligned}
-\laplace\psi^1&=0\\
\grad\psi^1\cdot \mathbf{n} &= \alpha_1
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (psi1) at (7,-3.5) {$\psi^1$} ;
\node[draw,scale=\taille,fill=gray!50] (pbgradpsi1) at (7,-4.75) {$w=\grad\psi^1$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.8cm]\ref{fvpsidiv}}] (pbpsi1div) at (9.5,-2)
{$\begin{aligned}
\mathbf{w}&=\grad\psi^1\\
\div \mathbf{w}&=0\\
\mathbf{w}\cdot \mathbf{n} &= \alpha_1
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (gradpsi1) at (8.25,-6) {$\grad\psi^1$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.8cm]\ref{pbbd1}}
] (pbb) at (8,-7.5) 
{$
d_k\lambda_k^2 = (\grad\psi^1,\mathbf{g_k}) - \langle\alpha_1,\psi_k\rangle
$} ;
\node[draw,scale=\taille,fill=blue!50] (b) at (5.5,-8.75) {$\curl \mathbf{b}$} ;

\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.3cm]\ref{fveigen}}] (pbeigen) at (13.5,2)
{$\begin{aligned}
\curll \mathbf{g}_i = \lambda_i^2\mathbf{g}_i\\
\div\mathbf{g}_i = 0\\
\mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0\\
\curl \mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0\\
(\curll \mathbf{g}_i\cdot \mathbf{n}\restr{\Gamma} = 0)
\end{aligned}$} ;
\node[draw,scale=\taille,fill=yellow!50] (lambdagi) at (13.5,-0.5) {$(\lambda_i,\mathbf{g}_i)$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=1.6cm]\ref{fvgi0}}] (pbgi0) at (13.5,-3)
{$\begin{aligned}
\grad(\div \mathbf{g_i^0})-\laplace \mathbf{g_i^0} &= \lambda_i^2\mathbf{g}_i\\
\mathbf{g_i^0} &= 0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=yellow!50] (gi0) at (13.5,-4.5) {$\mathbf{g_i^0}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=-0.9cm]\ref{fvpsiml}}] (pbpsi) at (13,-6)
{$\begin{aligned}
-\laplace\psi_i = \div \mathbf{g_i^0}\\
\grad\psi_i\cdot \mathbf{n}\restr{\Gamma} = 0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=yellow!50] (psi) at (12.5,-7.5) {$\psi_i$} ;

\node[draw,scale=\taille,fill=gray!50,label={[xshift=-1.1cm]\ref{a}}] (pba) at (2,-10.5) {$\mathbf{a} = \curl \mathbf{b} + \grad\psi^0$} ;
\node[draw,scale=\taillem,fill=blue!50] (a) at (2,-12) {$\mathbf{a}$} ;

\node[draw,scale=\taille,fill=green!50] (f) at (7,-9) {$f$} ;
\node[draw,scale=\taille,fill=green!50] (a2) at (8,-9) {$\alpha_2$} ;
\node[draw,scale=\taille,fill=green!50] (ck0) at (9,-9) {$c_k^0$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=3.3cm]\ref{fvc}}] (pbs) at (9,-12)
{$\begin{aligned}
\frac{\partial c_k}{\partial t} &+ \frac{1}{Re}c_k\lambda_k^2 + \sum_i\sum_j c_i c_j R_{ijk}\\
&+ \sum_i c_i R_{iak} + \sum_i c_i R_{raik} = R_{fk} + \frac{1}{Re}R_{pk}\\
c_k(0)&=c_k^0
\end{aligned}
$} ;
\node[draw,scale=\taille,fill=blue!50] (ck) at (9,-15) {$c_k$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.6cm]\ref{u}}] (pbu) at (9,-16) {$\mathbf{u}=\sum c_kg_k$} ;
\node[draw,scale=\taillem,fill=blue!50] (u) at (9,-17) {$\mathbf{u}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.5cm]\ref{v}}] (pbv) at (3,-18) {$\mathbf{v}=\mathbf{a}+\mathbf{u}$} ;
\node[draw,scale=\tailleg,fill=red!50] (v) at (3,-19) {$\mathbf{v}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=3.6cm]\ref{fvq}}] (pbq) at (9,-19)
{$\begin{aligned}
-\laplace q = \div((\curl \mathbf{v})\times \mathbf{v}) - \div \mathbf{f}\\
\grad q\cdot \mathbf{n}\restr{\Gamma} =  \mathbf{f}\cdot \mathbf{n}\restr{\Gamma} - \frac{\partial\alpha_0}{\partial t} - ((\curl \mathbf{v})\times \mathbf{v})\cdot \mathbf{n}\restr{\Gamma} - \frac{\alpha_2}{Re}
\end{aligned}$} ;
\node[draw,scale=\tailleg,fill=red!50] (q) at(15,-19) {$p$} ;

\draw[->,>=latex] (9,8) -- (coblig) ;
\draw[->,>=latex,purple] (9,7.5) -- (cpurple) ;
\draw[->,>=latex,green] (9,7) -- (cgreen) ;
\draw[->,>=latex,magenta] (9,6.5) -- (cmagenta) ;
\draw[->,>=latex,cyan] (9,6) -- (ccyan) ;
\draw[->,>=latex,red] (9,5.5) -- (cred) ;
\draw[->,>=latex,orange] (9,5) -- (corange) ;

\draw (a0) -- (0.75,0);
\draw[->,>=latex] (gradpsi0) -- (pba) ;
\draw[->,>=latex,purple] (0.75,0) -| (pbpsi0lp) ;
\draw[->,>=latex,purple] (pbpsi0lp) -- (psi0) ;
\draw[->,>=latex,purple] (psi0) -- (pbgradpsi0) ;
\draw[->,>=latex,purple] (pbgradpsi0) -- (gradpsi0) ;
\draw[->,>=latex,green] (0.75,0) -| (pbpsi0div) ;
\draw[->,>=latex,green] (pbpsi0div) -- (gradpsi0) ;

\draw (a1) -- (5.5,1);
\draw[->,>=latex,magenta] (5.5,1) -| (pbbcurl) ;
\draw[->,>=latex,magenta] (pbbcurl) -- (b) ;
\draw[cyan] (5.5,1) -| (8.25,0);
\draw[->,>=latex,orange] (8.25,0) -| (pbpsi1div);
\draw[->,>=latex,red] (8.25,0) -| (pbpsi1lp);
\draw[->,>=latex,red] (pbpsi1lp) -- (psi1);
\draw[->,>=latex,red] (psi1) -- (pbgradpsi1);
\draw[->,>=latex,red] (pbgradpsi1) -- (gradpsi1);
\draw[->,>=latex,orange] (pbpsi1div) -- (gradpsi1);
\draw[->,>=latex,cyan] (gradpsi1) -- (pbb);
\draw[->,>=latex,cyan] (psi) -- (pbb);
\draw[->,>=latex,cyan] (lambdagi) to[out=180,in=40] (pbb.15);
\draw[->,>=latex,cyan] (pbb) -- (b);
\draw[->,>=latex] (b) -- (pba);

\draw[->,>=latex] (pba) -- (a);
\draw[->,>=latex] (pbeigen) -- (lambdagi);
\draw[->,>=latex] (lambdagi) -- (pbgi0);
\draw[->,>=latex] (pbgi0) -- (gi0);
\draw[->,>=latex] (gi0) -- (pbpsi);
\draw[->,>=latex] (pbpsi) -- (psi);
\draw[->,>=latex] (a) -- (pbs);
\draw[->,>=latex] (f) -- (pbs);
\draw[->,>=latex] (a2) -- (pbs);
\draw[->,>=latex] (ck0) -- (pbs);
\draw[->,>=latex] (lambdagi) to[out=-10,in=20] (pbs.east);
\draw[->,>=latex] (psi) -- (pbs);
\draw[->,>=latex] (pbs) -- (ck);
\draw[->,>=latex] (ck) -- (pbu);
\draw[->,>=latex] (pbu) -- (u);
\draw[->,>=latex] (u) -- (pbv);
\draw[->,>=latex] (a) -- (pbv);
\draw[->,>=latex] (pbv) -- (v);
\draw[->,>=latex] (v) -- (pbq);
\draw[->,>=latex] (pbq) -- (q);
\end{tikzpicture}
\caption{Organigramme présentant les différents chemins possibles}
\label{org3}
\end{figure}

\begin{figure}
\centering
\begin{tikzpicture}[scale=\taille]
\node[scale=\taille,text width=10cm] (ccyan) at (5,4) {{\color{cyan} Chemins pour $\psi^0\in H^1$}} ;
\node[scale=\taille,text width=10cm] (cmagenta) at (5,3.5) {{\color{magenta} Chemins pour $\psi^0\in H(\mathrm{div})$}} ;
\node[draw,scale=\taille,fill=LimeGreen] (pbok) at (7,5) {Problèmes résolu} ;
\node[draw,scale=\taille,fill=ProcessBlue] (pbc) at (7,4) {Problèmes en cours} ;
\node[draw,scale=\taille,fill=gray!50] (pb) at (7,3) {Problèmes à résoudre} ;
\node[draw,scale=\taille,fill=green!50] (di) at (12,5) {Données initiales} ;
\node[draw,scale=\taille,fill=blue!50] (si) at (12,4) {Solutions intermédiaires} ;
\node[draw,scale=\taille,fill=yellow!50] (sim) at (12,3) {Sol. inter. dép. de la géométrie} ;
\node[draw,scale=\taille,fill=red!50] (sf) at (12,2) {Solutions finales} ;

\node[draw,scale=\taille,fill=green!50] (a0) at (0.75,2) {$\alpha_0$} ;
\node[draw,scale=\taille,fill=LimeGreen,label={[xshift=-0.7cm](\ref{fvpsi0})}] (pbpsi0lp) at (-0.5,-2)
{$\begin{aligned}
-\laplace\psi^0&=0\\
\grad\psi^0\cdot \mathbf{n} &= \alpha_0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (psi0) at (-0.5,-3.5) {$\psi^1$} ;
\node[draw,scale=\taille,fill=LimeGreen] (pbgradpsi0) at (-0.5,-4.75) {$w=\grad\psi^0$} ;
\node[draw,scale=\taille,fill=LimeGreen,label={[xshift=0.8cm](\ref{fvpsidiv})}] (pbpsi0div) at (2,-2)
{$\begin{aligned}
\mathbf{w}&=\grad\psi^0\\
\div\mathbf{w}&=0\\
\mathbf{w}\cdot \mathbf{n} &= \alpha_0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (gradpsi0) at (0.75,-6.5) {$\grad\psi^0$} ;

\node[draw,scale=\taille,fill=green!50] (a1) at (5,2) {$\alpha_1$} ;
\node[draw,scale=\taille,fill=gray!50] (pbbcurl) at (5,-2)
{{\Huge ?}} ;
\node[draw,scale=\taille,fill=blue!50] (b) at (5,-6.5) {$\curl \mathbf{b}$} ;

\node[draw,scale=\taille,fill=green!50] (a2) at (8,2) {$\alpha_2$} ;
\node[draw,scale=\taille,fill=gray!50] (pbe) at (8,-2)
{{\Huge ?}} ;
\node[draw,scale=\taille,fill=blue!50] (e) at (8,-6.5) {$\mathbf{e}$} ;

\node[draw,scale=\taille,fill=gray!50,label={[xshift=-1.3cm](\ref{a})}] (pba) at (3,-9) {$\mathbf{a} = \grad\psi^0 + \curl \mathbf{b} + \mathbf{e}$} ;
\node[draw,scale=\taillem,fill=blue!50] (a) at (3,-12) {$\mathbf{a}$} ;

\node[draw,scale=\taille,fill=LimeGreen,label={[xshift=1.0cm](\ref{pbcond})}] (pbeigen) at (11.5,-2)
     {$\begin{aligned}
         \curl \mbf{u} = \lambda \mbf{u} & \quad \mbox{in }\Omega\\
         \curl \mbf{u}\cdot\mbf{n} = 0 & \quad \mbox{on }\Gamma
       \end{aligned}$} ;
\node[draw,scale=\taille,fill=yellow!50] (lambdagi) at (11.5,-6.5) {$(\lambda_i^2,\mathbf{g}_i)$} ;

\node[draw,scale=\taille,fill=green!50] (f) at (8,-9) {$f$} ;
\node[draw,scale=\taille,fill=green!50] (ck0) at (9,-9) {$c_k^0$} ;
\node[draw,scale=\taille,fill=ProcessBlue,label={[xshift=3.2cm](\ref{fvc})}] (pbs) at (9,-12)
{$\begin{aligned}
\frac{\partial c_k}{\partial t} &+ \sum_i\sum_j c_i c_j(\curl\mathbf{g}_i\times \mathbf{g_j}, \mathbf{g_k}) \\
&+ \sum_i c_i(\curl\mathbf{g}_i\times \mathbf{a},\mathbf{g_k}) + \sum_i c_i((\curl \mathbf{a})\times \mathbf{g}_i, \mathbf{g_k}) \\
&+ \frac{1}{Re}c_k\lambda_k^2 = (\mathbf{f_a},\mathbf{g_k})
\end{aligned}
$} ;
\node[draw,scale=\taille,fill=blue!50] (ck) at (9,-15) {$c_k$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.7cm](\ref{u})}] (pbu) at (9,-16) {$\mathbf{u}=\sum c_kg_k$} ;
\node[draw,scale=\taillem,fill=blue!50] (u) at (9,-17) {$\mathbf{u}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=0.6cm](\ref{v})}] (pbv) at (3,-18) {$\mathbf{v}=\mathbf{a}+\mathbf{u}$} ;
\node[draw,scale=\tailleg,fill=red!50] (v) at (3,-19) {$\mathbf{v}$} ;
\node[draw,scale=\taille,fill=gray!50,label={[xshift=3.1cm](\ref{fvq})}] (pbq) at (9,-19)
{$\begin{aligned}
-\laplace q = \div((\curl \mathbf{v})\times \mathbf{v}) - \div \mathbf{f}\\
\grad q\cdot \mathbf{n}\restr{\Gamma} =  \mathbf{f}\cdot \mathbf{n}\restr{\Gamma} - \frac{\partial\alpha_0}{\partial t} - ((\curl \mathbf{v})\times \mathbf{v})\cdot \mathbf{n}\restr{\Gamma} - \frac{\alpha_2}{Re}
\end{aligned}$} ;
\node[draw,scale=\tailleg,fill=red!50] (q) at(15,-19) {$p$} ;

\draw[->,>=latex,cyan] (-1,4) -- (ccyan) ; \draw[->,>=latex,magenta] (-1,3.5) -- (cmagenta) ;
\draw (a0) -- (0.75,0); \draw[->,>=latex] (gradpsi0) -- (pba) ; \draw[->,>=latex,cyan] (0.75,0) -| (pbpsi0lp) ; \draw[->,>=latex,cyan] (pbpsi0lp) -- (psi0) ; \draw[->,>=latex,cyan] (psi0) -- (pbgradpsi0) ; \draw[->,>=latex,cyan] (pbgradpsi0) -- (gradpsi0) ; \draw[->,>=latex,magenta] (0.75,0) -| (pbpsi0div) ; \draw[->,>=latex,magenta] (pbpsi0div) -- (gradpsi0) ; \draw[->,>=latex] (gradpsi0) -- (pba) ;
\draw[->,>=latex] (a1) -- (pbbcurl) ; \draw[->,>=latex] (pbbcurl) -- (b) ; \draw[->,>=latex] (b) -- (pba) ;
\draw[->,>=latex] (a2) -- (pbe) ; \draw[->,>=latex] (pbe) -- (e) ; \draw[->,>=latex] (e) -- (pba) ;
\draw[->,>=latex] (pba) -- (a);
\draw[->,>=latex] (pbeigen) -- (lambdagi); \draw[->,>=latex] (lambdagi) -- (pbs) ;
\draw[->,>=latex] (a) -- (pbs); \draw[->,>=latex] (f) -- (pbs); \draw[->,>=latex] (ck0) -- (pbs);
\draw[->,>=latex] (pbs) -- (ck); \draw[->,>=latex] (ck) -- (pbu); \draw[->,>=latex] (pbu) -- (u); \draw[->,>=latex] (u) -- (pbv); \draw[->,>=latex] (a) -- (pbv); \draw[->,>=latex] (pbv) -- (v); \draw[->,>=latex] (v) -- (pbq); \draw[->,>=latex] (pbq) -- (q);
\end{tikzpicture}
\caption{Organigramme présentant les différents problèmes à résoudre}
\label{org3}
\end{figure}

%%% Local Variables:
%%% TeX-master: "../report.tex"
%%% eval: (flyspell-mode 1)
%%% ispell-local-dictionary: "french"
%%% End:
