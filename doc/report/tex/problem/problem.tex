\part{Problem}
\label{partProb}
Let $\Omega\subset\R^3$ be a bounded simply-connected domain with a
Lipschitz continuous boundary $\Gamma$. Let $\Gamma_0,\dots,\Gamma_I$
be the connected components of $\Gamma$.\\

We will use the following notations :
\begin{align*}
gradient(v)&=(\partial_x v, \partial_y v, \partial_z v)=\grad v\\
gradient(\mbf{v})&=\begin{pmatrix}
\partial_x v_x & \partial_y v_x & \partial_z v_x\\
\partial_x v_y & \partial_y v_y & \partial_z v_y\\
\partial_x v_z & \partial_y v_z & \partial_z v_z
\end{pmatrix}=\grad\mbf{v}\\
divergence(\mbf{v})&=\frac{\partial v_x}{\partial x}+\frac{\partial v_y}{\partial y}+\frac{\partial v_z}{\partial z}=\div \mbf{v}\\
curl(\mbf{v})&=\begin{pmatrix}
\partial_y v_z - \partial_z v_y\\
\partial_z v_x - \partial_x v_z\\
\partial_x v_y - \partial_y v_x
\end{pmatrix}=\curl \mbf{v}\\
curl(curl(\mbf{v}))&=\curll \mbf{v}\\
H^1(\Omega) &= \{v \in L^2(\Omega)\;|\; \grad v\in L^2(\Omega)\}\\
H^1_0(\Omega) &= \{v \in H^1(\Omega)\; |\; v\restr{\Gamma} = 0\}\\
H(\mathrm{div};\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \div\mbf{v} \in L^2(\Omega) \}\\
H(\mathrm{curl};\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \curl\mbf{v} \in L^2(\Omega) \}\\
L^2_\sigma(\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \div \mbf{v} = 0\text{ et }\mbf{v}\cdot \mbf{n}\restr{\Gamma} = 0 \}\\
D^1(\Omega) &= \{\mbf{v} \in [H^1(\Omega)]^3\cap L^2_\sigma(\Omega)\; |\; (\curl \mbf{v}\cdot \mbf{n})\restr{\Gamma} = 0  \}
\end{align*}

We are looking for $(\mbf{v},p)$, corresponding to the velocity and the pressure, solutions of the incompressible Navier-Stokes equations in $Q_T=\Omega\times[0,T]$, where $\Omega$ is an open set in $\R^3$ and $\partial\Omega$ its boundary, with initial condition and general impermeable boundary conditions.
\begin{pb}\label{start}
Find $(\mbf{v},p)$ such that :
\begin{equation*}
\left\{\begin{aligned}
&\frac{\partial \mbf{v}}{\partial t} + (\curl  \mbf{v})\times \mbf{v} + \grad q + \frac{1}{Re}\curll  \mbf{v}-\mbf{f} = 0\\
&\div \mbf{v} = 0\\
&\mbf{v}\big\rvert_{t=0} = \mbf{v}_0\\
&\mbf{v}\cdot \mbf{n}\restr{\Gamma} = \alpha_0\\
&(\curl  \mbf{v})\cdot \mbf{n}\restr{\Gamma} = \alpha_1\\
&(\curll  \mbf{v})\cdot \mbf{n}\restr{\Gamma} = \alpha_2
\end{aligned}\right.
\end{equation*}
where $q = \frac{|\mbf{v}|^2}{2}+p$.\\
\end{pb}
This problem has non standards boundary conditions. Rather than Dirichlet conditions, we use $\nabla^k\times\mbf{v}\cdot\mbf{n}\restr{\Gamma}$ for $k=0,1,2$ with $\nabla^0\times=Id$.\\
There have been few studies about these conditions and the industry rarely uses it. We can cite the works of V. Girault \cite{girault90-1}, H. Bellout, J. Neustuppa and P. Penel \cite{Penel2004}. The principle is a Galerkin type decomposition that can be related to the works of E. Deriaz and V. Perrier \cite{Deriaz2009249}.\\

The interest for Plastic Omnium is to be able to split the variables in time and space, and hence compute longer simulations. Furtermore, this could mean that we wouldn't need wall functions boundary condition, and so the boundary layer become needless.\\ 

We can now explain the resolution's strategy in the chapter \ref{strategy}, then study each step of the resolution in more details in \ref{fv}.

\chapter{Resolution's Strategy}
\label{strategy}
According to \cite{Penel2004}, the existence and unicity of the solution are guaranteed if the solution lives in $D^1$, which means that $\nabla^k\times\mbf{v}\cdot\mbf{n}\restr{\Gamma}=0$ for $k=0,1$. We need to relief these boundary conditions with a function $\mbf{a}$. We want to write $\mbf{v}=\mbf{u}+\mbf{a}$, such that :\\
\begin{equation}\label{v}
\begin{array}{c|ccccc}
& \mbf{v} & = & \mbf{a} & + & \mbf{u}\\ \hline
\div\star & 0 & & 0 & & 0\\ \hline
\star\cdot \mbf{n}\restr{\Gamma} & \alpha_0 & & \alpha_0 & & 0\\ \hline
\curl\star\cdot \mbf{n}\restr{\Gamma} & \alpha_1 & & \alpha_1 & & 0\\ \hline
\curll\star\cdot \mbf{n}\restr{\Gamma} & \alpha_2 & & \alpha_2 & & 0
\end{array}
\end{equation}
We have $\mbf{u}\in D^1(\Omega)$ to define the solution in the interior of the domain and $\mbf{a}\in [L^2(\Omega)]^3$ that we use for the boundary conditions.
\begin{pb}\label{a}
Find $\mbf{a}\in [L^2(\Omega)]^3$ such that :
\begin{equation*}
\left\{\begin{aligned}
&\mbf{a}=\grad a_0 + \curl\mbf{a}_1 + \mbf{a}_2\\
&\div \mbf{a} =0\\
&\mbf{a}\cdot \mbf{n}\restr{\Gamma} = \alpha_0\\
&(\curl \mbf{a})\cdot \mbf{n}\restr{\Gamma} = \alpha_1\\
&(\curll\mbf{a})\cdot\mbf{n}\restr{\Gamma} = \alpha_2
\end{aligned}\right.
\end{equation*}
\end{pb}
By applying the divergence and the boundary contions to the first lign, it leads to :
\begin{center}
\begin{tabular}{c|ccccccc}
& $\mbf{a}$ & = & $\grad a_0$ & + & $\curl \mbf{a}_1$ & + & $\mbf{a}_2$ \\ \hline
$\div\star$ & 0 & & $\laplace a_0$ & & 0 & & 0\\ \hline
$\star\cdot \mbf{n}\restr{\Gamma}$ & $\alpha_0$ & & $\alpha_0$ & & 0 & & 0\\ \hline
  $\curl\star\cdot \mbf{n}\restr{\Gamma}$ & $\alpha_1$ & & 0 & & $\alpha_1$ & & 0\\ \hline
  $\curll\star\cdot\mbf{n}\restr{\Gamma}$ & $\alpha_2$ & & 0 & & 0 & & $\alpha_2$
\end{tabular}
\end{center}
With the two first ligns of the table, we get the problem :
\begin{pb}\label{pba0}
Find $a_0$ such that :
\begin{equation*}
\left\{\begin{aligned}
&-\laplace a_0 = 0\\
&\grad a_0\cdot \mbf{n}\restr{\Gamma}=\alpha_0
\end{aligned}\right.
\end{equation*}\end{pb}
This problem allows us to find $a_0$ up to a constant, we need to use Lagrange multiplier to add a constraint, for example $\int_Omega a_0=0$. We can choose the constant because we only need the gradient.\\
We'll discuss which way we solve the problem \ref{pba0} further.\\

Let $\mbf{a}_1$ solution of the mixed problem :
\begin{pb}\label{pba1}
Find $(\mbf{a}_1,\psi^1)$ tel que :
\begin{equation*}
\left\{\begin{aligned}
&\curll \mbf{a}_1 = \grad\psi^1\\
&\div \mbf{a}_1 = 0\\
&\mbf{a}_1\cdot \mbf{n}\restr{\Gamma} = 0\\
&\curl \mbf{a}_1\cdot \mbf{n}\restr{\Gamma} = 0\\
&\grad\psi^1\cdot \mbf{n}\restr{\Gamma} = \alpha_1
\end{aligned}\right.
\end{equation*}\end{pb}

Let $\mbf{a}_2$ solution of the following problem :
\begin{pb}\label{pba2}
  Find $\mbf{a}_2$ such that :
  \begin{equation*}
    \left\{\begin{aligned}
    &\curll\mbf{a}_2 = \bm{\epsilon}\\
    &\div \mbf{a}_2 = 0\\
    &\mbf{a}_2\cdot\mbf{n}\restr{\Gamma} = 0\\
    &\curl\mbf{a}_2\cdot\mbf{n}\restr{\Gamma} = 0\\
    &\curll\mbf{a}_2\cdot\mbf{n}\restr{\Gamma} = \alpha_2
    \end{aligned}\right.
  \end{equation*}
  Such that $\bm{\epsilon}\cdot\mbf{n} = \alpha_2$
\end{pb}

Once we know $\grad a_0$, $\curl\mbf{a}_1$ and $\mbf{a}_2$, we have $\mbf{a}$.\\

We can replace $\mbf{v}$ by $\mbf{u}+\mbf{a}$ in problem \ref{start} :
\[ \frac{\partial(\mbf{u}+\mbf{a})}{\partial t}+(\curl(\mbf{u}+\mbf{a}))\times(\mbf{u}+\mbf{a}) + \grad (\frac{|\mbf{u}+\mbf{a}|^2}{2}+p) + \frac{1}{Re}\curll(\mbf{u}+\mbf{a}) - \mbf{f} = 0 \]
Which leads to, by noting $\pi_a=\frac{|\mbf{u}+\mbf{a}|^2}{2}+p$ :
\[ \frac{\partial \mbf{u}}{\partial t}+\frac{\partial \mbf{a}}{\partial t} + (\curl \mbf{u}+\curl \mbf{a})\times(\mbf{u}+\mbf{a}) + \grad\pi_{\mbf{a}} + \frac{1}{Re}(\curll \mbf{u}+\curll \mbf{a}) - \mbf{f} = 0 \]
We have that $\curll \mbf{a} = \bm{\epsilon}$, then if $\mbf{f_a}=\mbf{f}-\frac{\partial \mbf{a}}{\partial t} - (\curl \mbf{a})\times \mbf{a} - \bm{\epsilon}$, we have the following problem :
\begin{pb}\label{pbu}
Find $\mbf{u}$ such that :
\begin{equation*}
\left\{\begin{aligned}
&\frac{\partial \mbf{u}}{\partial t} + (\curl \mbf{u})\times \mbf{u} + (\curl \mbf{u})\times \mbf{a} +(\curl \mbf{a})\times \mbf{u} + \grad \pi_{\mbf{a}} +\frac{1}{Re}\curll  \mbf{u} - \mbf{f_a} = 0\\
&\div \mbf{u} = 0\\
&\mbf{u}\big\rvert_{t=0} = \mbf{v}_0 - \mbf{a}(0,\cdot)\\
&\mbf{u}\cdot \mbf{n}\restr{\Gamma} = 0\\
&(\curl \mbf{u})\cdot \mbf{n}\restr{\Gamma} = 0\\
&(\curll  \mbf{u})\cdot \mbf{n}\restr{\Gamma} = 0
\end{aligned}\right.
\end{equation*}\end{pb}

Using a Galerkin decomposition, we have :
\begin{equation}\label{u}
\mbf{u}(t,\cdot) = \sum_{i=1}^{\infty} c_i(t)\mbf{g}_i(\cdot)
\end{equation}
where we have separeted the variables depending on time and space. The coefficients $c_i$ include all informations depending on the time, whereas the functions $\mbf{g}_i$ carry the spacial component.\\

Since $\mbf{u}\in D^1(\Omega)=D(\mathrm{rot}_{imperm})$, according to \cite{Penel2004}, a basis of this space is the eigen functions $\mbf{g}_i$ of the curl operator.
So, we want to solve the eigen problem :
\begin{pb}\label{pbcurl}
Find $(\lambda_i,\mbf{g}_i)\in\R\times D^1(\Omega)$ such that :
\begin{equation*}
\left\{\begin{aligned}
&\curl  \mbf{g}_i = \lambda_i \mbf{g}_i\\
&\div\mbf{g}_i = 0\\
&\mbf{g}_i\cdot \mbf{n}\restr{\Gamma} = 0\\
&\curl \mbf{g}_i\cdot \mbf{n}\restr{\Gamma} = 0
\end{aligned}\right.
\end{equation*}\end{pb}

By injecting \ref{u} in the problem \ref{pbu}, we get :
\begin{align*}
\frac{\partial}{\partial t}\left(\sum_{i=1}^\infty c_i\mbf{g}_i\right) &+ \left(\curl \left(\sum_{i=1}^\infty c_i\mbf{g}_i\right)\right)\times \left(\sum_{i=1}^\infty c_i\mbf{g}_i\right) + \left(\curl \left(\sum_{i=1}^\infty c_i\mbf{g}_i\right)\right)\times \mbf{a}&\\
&+ (\curl \mbf{a})\times \left(\sum_{i=1}^\infty c_i\mbf{g}_i\right) + \grad \pi_{\mbf{a}} +\frac{1}{Re}\curll  \left(\sum_{i=1}^\infty c_i\mbf{g}_i\right) - \mbf{f_a} =0\\
\end{align*}

Using the linearity of the derivative operator, as well as that of the curl operator, we have :
\begin{pb}\label{pbc}
Find $(c_i)$ such that :
\begin{align*}
\sum_{i=1}^\infty\frac{\partial c_i}{\partial t}\mbf{g}_i &+ \sum_{i=1}^\infty\sum_{j=1}^\infty c_i c_j((\curl\mbf{g}_i)\times \mbf{g}_j) + \sum_{i=1}^\infty c_i((\curl\mbf{g}_i)\times \mbf{a})\\
& + \sum_{i=1}^\infty c_i((\curl\mbf{a})\times \mbf{g}_i) + \grad \pi_{\mbf{a}} +\frac{1}{Re}\sum_{i=1}^\infty c_i\curll\mbf{g}_i - \mbf{f_a} = 0\\
\end{align*}
with \[ \sum_{i=1}^\infty c_i(0)\mbf{g}_i = \mbf{v_0}-\mbf{a}(0,\cdot) \]
\end{pb}

To summarize, we have to :
\begin{enumerate}
\item generate the basis $\{\mbf{g}_i\}$ from the eigen functions of the curl operator by solving \ref{pbcurl} as explain in the chapter \ref{eigen}.
\item find $\mbf{a}$ to decompose $\mbf{v}$ as $\mbf{u}+\mbf{a}$, for this, we solve the problems \ref{pba0},\ref{pba1} and \ref{pba2}. Which allows us to compute $\mbf{a}$ with \ref{a}. This part is details in \ref{relev}.
\item solve problem \ref{pbc} to find the coefficients $c_i$. This is explain in chapter \ref{spectre}.
\item recompose $\mbf{v}=\mbf{u}+\mbf{a}$, and find $p$ to get the solution of the problem \ref{start}. The chapter \ref{pressure} explains how to do it.
\end{enumerate}

The strategy is presented in the figure \ref{org1}.
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \node[draw,scale=\taille,fill=green!50] (alpha0) at (-1,10) {$\alpha_0$};
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=0.9cm]\ref{pba0}}] (pba0) at (-1,8){
      $\begin{aligned}
        -\laplace a_0&=0\\
        \grad a_0\cdot \mbf{n} &= \alpha_0
      \end{aligned}$
    };
    \node[draw,scale=\taille,fill=blue!50] (grada0) at (-1,5.5) {$\grad a_0$} ;
    \node[draw,scale=\taille,fill=green!50] (alpha1) at (1.5,10) {$\alpha_1$};
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=1.1cm]\ref{pba1}}] (pba1) at (1.5,8){
      $\begin{aligned}
        \curll \mbf{a}_1 = \grad\psi^1\\
        \div \mbf{a}_1 = 0\\
        \mbf{a}_1\cdot \mbf{n}\restr{\Gamma} = 0\\
        \curl \mbf{a}_1\cdot \mbf{n}\restr{\Gamma} = 0\\
        \grad\psi^1\cdot \mbf{n}\restr{\Gamma} = \alpha_1
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (curla1) at (1.5,5.5) {$(\curl\mbf{a}_1,\grad\psi^1)$} ;
    \node[draw,scale=\taille,fill=green!50] (alpha2) at (4,10) {$\alpha_2$};
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=1.1cm]\ref{pba2}}] (pba2) at (4,8){
      $\begin{aligned}
        \curll \mbf{a}_2 = \bm{\epsilon}\\
        \div \mbf{a}_2 = 0\\
        \mbf{a}_2\cdot \mbf{n}\restr{\Gamma} = 0\\
        \curl \mbf{a}_2\cdot \mbf{n}\restr{\Gamma} = 0\\
        \bm{\epsilon}\cdot \mbf{n}\restr{\Gamma} = \alpha_2
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (a2) at (4,5.5) {$(\curl\mbf{a}_2,\bm{\epsilon})$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=1.5cm]\ref{a}}] (pba) at (1.5,4) {$\mbf{a}=\grad a_0+\curl\mbf{a}_1+\mbf{a}_2$};
    \node[draw,scale=\taillem,fill=blue!50] (a) at (1.5,3) {$\mbf{a}$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=1.1cm]\ref{pbcurl}}] (pbcurl) at (10,8) {
      $\begin{aligned}
        \curl \mbf{g}_i = \lambda_i\mbf{g}_i\\
        \div\mbf{g}_i = 0\\
        \mbf{g}_i\cdot \mbf{n}\restr{\Gamma} = 0\\
        \curl\mbf{g}_i\cdot \mbf{n}\restr{\Gamma} = 0
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=yellow!50] (lambdagi) at (10, 5.5) {$(\lambda_i,\mbf{g}_i)$} ;
    \node[draw,scale=\taille,fill=green!50] (f) at (6.75,5.5) {$\mbf{f}$};
    \node[draw,scale=\taille,fill=green!50] (c0) at (7.75,5.5) {$c_i(0)$};
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=4.5cm]\ref{pbc}}] (pbc) at (8.5,3) {
      $\begin{aligned}
        \sum_{i=1}^\infty\frac{\partial c_i}{\partial t}\mbf{g}_i &+ \sum_{i=1}^\infty\sum_{j=1}^\infty c_i c_j((\curl\mbf{g}_i)\times \mbf{g}_j) + \sum_{i=1}^\infty c_i((\curl\mbf{g}_i)\times \mbf{a})\\
        & + \sum_{i=1}^\infty c_i((\curl\mbf{a})\times \mbf{g}_i) + \grad \pi_{\mbf{a}} +\frac{1}{Re}\sum_{i=1}^\infty c_i\curll\mbf{g}_i - \mbf{f_a} = 0
      \end{aligned}$
    };
    \node[draw,scale=\taillem,fill=blue!50] (u) at (8.5,1) {$\mbf{u}$} ;
    \node[draw,scale=\taille,fill=gray!50] (pbv) at (5,-0.5) {$\mbf{v}=\mbf{a}+\mbf{u}$} ;
    \node[draw,scale=\tailleg,fill=red!50] (v) at (5,-2) {$(\mbf{v},p)$} ;

    \draw[->,>=latex] (alpha0) -- (pba0); \draw[->,>=latex] (pba0) -- (grada0); \draw[->,>=latex] (alpha1) -- (pba1); \draw[->,>=latex] (pba1) -- (curla1); \draw[->,>=latex] (alpha2) -- (pba2); \draw[->,>=latex] (pba2) -- (a2); \draw[->,>=latex] (grada0) -- (pba); \draw[->,>=latex] (curla1) -- (pba); \draw[->,>=latex] (a2) -- (pba); \draw[->,>=latex] (pba) -- (a); \draw[->,>=latex] (pbcurl) -- (lambdagi); \draw[->,>=latex] (a) -- (pbc); \draw[->,>=latex] (f) -- (pbc); \draw[->,>=latex] (c0) -- (pbc); \draw[->,>=latex] (lambdagi) -- (pbc); \draw[->,>=latex] (pbc) -- (u); \draw[->,>=latex] (u) -- (pbv); \draw[->,>=latex] (a) -- (pbv); \draw[->,>=latex] (pbv) -- (v);
  \end{tikzpicture}
  \caption{Flow chart of the resolution's strategy}\label{org1}
\end{figure}

\chapter{Weak Formulations}
\label{fv}
Now that how we proceed to solve the problem \ref{start} is clear, we can detail each step mentionned before.

\input{./tex/problem/mode}

\input{./tex/problem/relev}

\input{./tex/problem/ps}

\input{./tex/problem/press}

\chapter{Recapitulatif}

The steps to resolve the problm are :
\begin{enumerate}
\item compute the eigenpairs of the curl operator with problem \ref{pbweak},
  \todo[inline]{Ok}
\item decompose those functions with \ref{fvgi0} and \ref{fvpsiml},
  \todo[inline]{May be not necessary}
\item find $a_0$, using one of the following :
  \begin{itemize}
  \item solve \ref{fva0} to have $a_0\in H^1$,
  \item solve \ref{fva0div} to have $a_0\in H(\mathrm{div})$,
  \end{itemize}
  \todo[inline]{Ok}
\item solve \ref{fva1} or \ref{pbbd1} to find $\curl\mbf{a}_1$,
  \todo[inline]{to check}
\item solve \ref{fva2} to find $\mbf{a}_2$;
  \todo[inline]{to check}
\item recompose $\mbf{a}$ thanks to $\grad a_0$, $\curl\mbf{a}_1$ and $\mbf{a}_2$,
\item \label{itemsp} solve the spectral proble \ref{fvc} in order to find the coefficients $c_i$ for $i=0\dots M$,
  \todo[inline]{Ok}
\item rebuild $\mbf{u}=\sum c_i \mbf{g}_i$ and $\mbf{v}=\mbf{a}+\mbf{u}$,
\item compute the pressure in post-traitment with \ref{fvq}.
\end{enumerate}

We now have find our solution $(\mbf{v},p)$.\\

The first step depends only on the geometry, so we can reuse the eigen functions even after changing some parameters. The step \ref{itemsp} is the most time consumming one. We need to compute a lot of coefficient before starting. Luckily, the most of them depend only on the geometry, so we can compute them only once, but the others depend on the parameters and even worse, can also depend on the time, si we could have to recompute them at each time step.\\

The figure \ref{org3} graphically represents the problems to solve.\\

\begin{figure}
  \centering
  \begin{tikzpicture}[scale=\taille]
    \node[scale=\taille,text width=10cm] (ccyan) at (5,4) {{\color{cyan} Chemins pour $\psi^0\in H^1$}} ;
    \node[scale=\taille,text width=10cm] (cmagenta) at (5,3.5) {{\color{magenta} Chemins pour $\psi^0\in H(\mathrm{div})$}} ;
    \node[draw,scale=\taille,fill=green!50] (di) at (12,5) {Données initiales} ;
    \node[draw,scale=\taille,fill=blue!50] (si) at (12,4) {Solutions intermédiaires} ;
    \node[draw,scale=\taille,fill=yellow!50] (sim) at (12,3) {Sol. inter. dép. de la géométrie} ;
    \node[draw,scale=\taille,fill=red!50] (sf) at (12,2) {Solutions finales} ;

    \node[draw,scale=\taille,fill=green!50] (alpha0) at (0.75,2) {$\alpha_0$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=-0.7cm](\ref{fva0})}] (pba0) at (-0.5,-2){
      $\begin{aligned}
        -\laplace\psi^0&=0\\
        \grad\psi^0\cdot \mbf{n} &= \alpha_0
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (a0) at (-0.5,-3.5) {$a_0$} ;
    \node[draw,scale=\taille,fill=gray!50] (pbgrada0) at (-0.5,-4.75) {$w=\grad a_0$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=0.8cm](\ref{fva0div})}] (pba0div) at (2,-2){
      $\begin{aligned}
        \mbf{w}&=\grad a_0\\
        \div\mbf{w}&=0\\
        \mbf{w}\cdot \mbf{n} &= \alpha_0
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (grada0) at (0.75,-6.5) {$\grad a_0$} ;

    \node[draw,scale=\taille,fill=green!50] (alpha1) at (5,2) {$\alpha_1$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=0.8cm](\ref{fva1})}] (pba1) at (5,-2){
      $\begin{aligned}
        \curll \mbf{a}_1 &= \grad\psi^1\\
        \div \mbf{a}_1 &=0\\
        \mbf{a}_1\cdot \mbf{n} &= 0\\
        \curl \mbf{a}_1\cdot \mbf{n} &= 0\\
        \grad \psi^1\cdot \mbf{n} &= \alpha_1
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (a1) at (5,-6.5) {$\curl\mbf{a}_1$} ;

    \node[draw,scale=\taille,fill=green!50] (alpha2) at (8,2) {$\alpha_2$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=0.8cm](\ref{fva2})}] (pba2) at (8,-2){
      $\begin{aligned}
        \curll \mbf{a}_2 &= \bm{\epsilon}\\
        \div \mbf{a}_2 &=0\\
        \mbf{a}_2\cdot \mbf{n} &= 0\\
        \curl \mbf{a}_2\cdot \mbf{n} &= 0\\
        \bm{\epsilon}\cdot \mbf{n} &= \alpha_2
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (a2) at (8,-6.5) {$\mbf{a}_2$} ;

    \node[draw,scale=\taille,fill=gray!50,label={[xshift=-1.3cm](\ref{a})}] (pba) at (3,-9) {$\mbf{a} = \grad a_0 + \curl \mbf{a}_1 + \mbf{a}_2$} ;
    \node[draw,scale=\taillem,fill=blue!50] (a) at (3,-12) {$\mbf{a}$} ;

    \node[draw,scale=\taille,fill=LimeGreen,label={[xshift=1.0cm](\ref{pbcond})}] (pbcond) at (11.5,-2){
      $\begin{aligned}
        \curl \mbf{u} = \lambda \mbf{u} & \quad \mbox{in }\Omega\\
        \curl \mbf{u}\cdot\mbf{n} = 0 & \quad \mbox{on }\Gamma
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=yellow!50] (lambdagi) at (11.5,-6.5) {$(\lambda_i^2,\mbf{g}_i)$} ;

    \node[draw,scale=\taille,fill=green!50] (f) at (8,-9) {$f$} ;
    \node[draw,scale=\taille,fill=green!50] (c0) at (9,-9) {$c_k^0$} ;
    \node[draw,scale=\taille,fill=ProcessBlue,label={[xshift=3.2cm](\ref{fvc})}] (pbsp) at (9,-12){
      $\begin{aligned}
        \frac{\partial c_k}{\partial t} &+ \sum_i\sum_j c_i c_j(\curl\mbf{g}_i\times \mbf{g_j}, \mbf{g_k}) \\
        &+ \sum_i c_i(\curl\mbf{g}_i\times \mbf{a},\mbf{g_k}) + \sum_i c_i((\curl \mbf{a})\times \mbf{g}_i, \mbf{g_k}) \\
        &+ \frac{1}{Re}c_k\lambda_k^2 = (\mbf{f_a},\mbf{g_k})
      \end{aligned}$
    } ;
    \node[draw,scale=\taille,fill=blue!50] (ck) at (9,-15) {$c_k$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=0.7cm](\ref{u})}] (pbu) at (9,-16) {$\mbf{u}=\sum c_kg_k$} ;
    \node[draw,scale=\taillem,fill=blue!50] (u) at (9,-17) {$\mbf{u}$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=0.6cm](\ref{v})}] (pbv) at (3,-18) {$\mbf{v}=\mbf{a}+\mbf{u}$} ;
    \node[draw,scale=\tailleg,fill=red!50] (v) at (3,-19) {$\mbf{v}$} ;
    \node[draw,scale=\taille,fill=gray!50,label={[xshift=3.1cm](\ref{fvq})}] (pbq) at (9,-19){
      $\begin{aligned}
        -\laplace q = \div((\curl \mbf{v})\times \mbf{v}) - \div \mbf{f}\\
        \grad q\cdot \mbf{n}\restr{\Gamma} =  \mbf{f}\cdot \mbf{n}\restr{\Gamma} - \frac{\partial\alpha_0}{\partial t} - ((\curl \mbf{v})\times \mbf{v})\cdot \mbf{n}\restr{\Gamma} - \frac{\alpha_2}{Re}
      \end{aligned}$
    } ;
    \node[draw,scale=\tailleg,fill=red!50] (q) at(15,-19) {$p$} ;

    \draw[->,>=latex,cyan] (-1,4) -- (ccyan) ; \draw[->,>=latex,magenta] (-1,3.5) -- (cmagenta) ;
    \draw (alpha0) -- (0.75,0); \draw[->,>=latex] (grada0) -- (pba) ; \draw[->,>=latex,cyan] (0.75,0) -| (pba0) ; \draw[->,>=latex,cyan] (pba0) -- (a0) ; \draw[->,>=latex,cyan] (a0) -- (pbgrada0) ; \draw[->,>=latex,cyan] (pbgrada0) -- (grada0) ; \draw[->,>=latex,magenta] (0.75,0) -| (pba0div) ; \draw[->,>=latex,magenta] (pba0div) -- (grada0) ; \draw[->,>=latex] (grada0) -- (pba) ;
    \draw[->,>=latex] (alpha1) -- (pba1) ; \draw[->,>=latex] (pba1) -- (a1) ; \draw[->,>=latex] (a1) -- (pba) ;
    \draw[->,>=latex] (alpha2) -- (pba2) ; \draw[->,>=latex] (pba2) -- (a2) ; \draw[->,>=latex] (a2) -- (pba) ;
    \draw[->,>=latex] (pba) -- (a);
    \draw[->,>=latex] (pbcond) -- (lambdagi); \draw[->,>=latex] (lambdagi) -- (pbsp) ;
    \draw[->,>=latex] (a) -- (pbsp); \draw[->,>=latex] (f) -- (pbsp); \draw[->,>=latex] (c0) -- (pbsp);
    \draw[->,>=latex] (pbsp) -- (ck); \draw[->,>=latex] (ck) -- (pbu); \draw[->,>=latex] (pbu) -- (u); \draw[->,>=latex] (u) -- (pbv); \draw[->,>=latex] (a) -- (pbv); \draw[->,>=latex] (pbv) -- (v); \draw[->,>=latex] (v) -- (pbq); \draw[->,>=latex] (pbq) -- (q);
  \end{tikzpicture}
  \caption{Flow chart of the problems to solve}
  \label{org3}
\end{figure}

%%% Local Variables:
%%% TeX-master: "../report.tex"
%%% eval: (flyspell-mode 1)
%%% ispell-local-dictionary: "english"
%%% End:
