\documentclass{beamer}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[frenchb]{babel}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{colortbl}
\usepackage{tikz}

\graphicspath{{Images/}}

\usetheme{Hannover}

\beamertemplatenavigationsymbolsempty

\definecolor{bleufonce}{rgb}{0.1,0.1,0.8}
\definecolor{grisbleu}{rgb}{0.8,0.8,0.9}
\definecolor{rougefonce}{rgb}{0.8,0.1,0.1}
\definecolor{grisrouge}{rgb}{0.9,0.8,0.8}
\definecolor{vertfonce}{rgb}{0.1,0.8,0.1}
\definecolor{grisvert}{rgb}{0.8,0.9,0.8}
\definecolor{bleuunistra}{RGB}{15,80,150}
\setbeamercolor{palette quaternary}{fg=white,bg=bleuunistra}
\setbeamercolor{titlelike}{parent=palette quaternary}

\setbeamertemplate{blocks}[rounded][shadow=true] 
\setbeamercolor{block title}{bg=bleufonce,fg=white}
\setbeamercolor{block body}{bg=grisbleu}
\setbeamercolor{block title alerted}{bg=rougefonce,fg=white}
\setbeamercolor{block body alerted}{bg=grisrouge}
\setbeamercolor{block title example}{bg=vertfonce,fg=white}
\setbeamercolor{block body example}{bg=grisvert}

\newcommand{\grad}{{\nabla}}
\newcommand{\laplace}{{\Delta}}
\newcommand{\rot}{{\nabla\times}}
\newcommand{\rott}{{\nabla^2\times}}
\newcommand{\diverg}{{\nabla\cdot}}
\newcommand{\restr}{{\big\rvert_{\partial\Omega}}}
\newcommand{\taille}{0.4}
\newcommand{\taillem}{0.5}
\newcommand{\tailleg}{0.7}

\title[Stage]{Parallélisation d'un code de calcul aérodynamique instationnaire et validation par comparaison avec des données existantes.}
\subtitle{Plastic Omnium, M2 CSMI}

\author{Romain HILD}
\institute{Université de Strasbourg}

\begin{document}

\begin{frame}
\includegraphics[scale=0.2]{uds.jpg}\includegraphics[scale=0.15]{po.jpg}
\titlepage
\end{frame}

\section{Problème}
\begin{frame}{Problème}
\begin{block}{On cherche (v,p) solution de :}
\begin{eqnarray}
\label{depart}
\left\{
\begin{aligned}
&\frac{\partial v}{\partial t} + (\rot  v)\times v + \grad q + \frac{1}{Re}\rott  v-f = 0\\
&\diverg v = 0\\
&v\big\rvert_{t=0} = v_0\\
&v\cdot n\restr = \alpha_0\\
&(\rot  v)\cdot n\restr = \alpha_1\\
&(\rott  v)\cdot n\restr = \alpha_2
\end{aligned}
\right.
\end{eqnarray}
où $q = \frac{|v|^2}{2}+p$.
\end{block}
\end{frame}

\begin{frame}{Décomposition}
\begin{block}{Décomposition des problèmes}
\begin{center}
\begin{tabular}{|c|c|}
\hline
Variables & Problèmes\\ \hline
$v$ & $a + u$ \\ \hline
$a$ & $\grad\psi_0 + \rot b$\\ \hline
$\psi_0$ & $-\laplace\psi_0 = 0$\\ \hline
$(b,\psi_1)$ & $\rott b= \grad\psi_1$ \\ \hline
u & $\sum_i c_ig_i$ \\ \hline
$(\lambda_i,g_i)$ & $\rott  g_i = \lambda_i^2 g_i$ \\ \hline
$g_i^0$ & $\grad(\diverg g_i^0) - \laplace g_i^0 = - \laplace g_i$\\ \hline
$\psi_i$ & $-\laplace \psi_i = 0$\\ \hline
\end{tabular}
\end{center}
La partie difficile est donc repoussé à trouver les coefficients $c_i$. 
\end{block}
\end{frame}

\section{Relèvement}
\begin{frame}{$v=a+u$}
\begin{block}{Relèvement par $a$ pour utiliser les travaux de P. Penel}
\begin{center}
\begin{tabular}{c|ccccc}
& v & = & a & + & u \\ \hline
$\diverg\star$ & 0 & & 0 & & 0\\ \hline
$\star\cdot n\restr$ & $\alpha_0$ & & $\alpha_0$ & & 0\\ \hline
$\rot\star\cdot n\restr$ & $\alpha_1$ & & $\alpha_1$ & & 0\\\hline
$\rott\star\cdot n\restr$ & $\alpha_2$ & & 0 & & $\alpha_2$ 
\end{tabular}
\end{center}
\end{block}
\end{frame}

\begin{frame}{$a=\grad\psi_0+\rot b$}
\begin{block}{Décomposition de $a$}
\begin{center}
\begin{tabular}{c|ccccc}
& $a$ & = & $\grad\psi_0$ & + & $\rot b$ \\ \hline
$\diverg\star$ & 0 & & $\laplace\psi_0$ & & 0\\ \hline
$\star\cdot n\restr$ & $\alpha_0$ & & $\alpha_0$ & & 0\\ \hline
$\rot\star\cdot n\restr$ & $\alpha_1$ & & 0 & & $\alpha_1$
\end{tabular}
\end{center}
\end{block}
\begin{block}{$\alpha_0$ est porté par $\grad\psi_0$}
\begin{itemize}
\item Problème :
\[\left\{
\begin{aligned}
&-\laplace\psi_0 = 0\\
&\grad\psi_0\cdot n\restr=\alpha_0
\end{aligned}
\right.\]
\item Formulation variationnelle :
\[
-\int_\Omega \grad\psi_0\cdot\grad\varphi + \int_{\partial\Omega} \alpha_0\varphi = 0
\]
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{$a=\grad\psi_0+\rot b$}
\begin{block}{$\alpha_1$ est porté par $\rot b$}
\begin{itemize}
\item Problème :
\[\left\{
\begin{aligned}
&\rott b = \grad\psi_1\\
&\diverg b = 0\\
&b\cdot n\restr = 0\\
&\rot b\cdot n\restr = 0\\
&\grad\psi_1\cdot n\restr = \alpha_1
\end{aligned}
\right.\]
\item Formulation variationnelle :
\begin{align*}
\int_\Omega (\rot b)(\rot\varphi) &- \int_{\partial\Omega} (\rot b)(\varphi\cdot n) \\
&+\int_\Omega \psi_1(\diverg\varphi) - \int_{\partial\Omega} \psi_1(\varphi\cdot n) = 0
\end{align*}
\end{itemize}
\end{block}
\end{frame}

\section{Galerkin}
\begin{frame}{$u=\sum c_ig_i$}
\begin{block}{Décomposition de Galerkin généralisée}
\begin{itemize}
\item les coefficients $c_i$ portent la dimension temporelle.
\item les fonctions de base de $D^1$ portent la dimension spatiale.
\item $D^1$ est engendré par les fonctions propres de l'opérateur rotationnel.
\item les fonctions propres de $\rot\star$ sont aussi celles de $\rott\star$.
\item les valeurs propres de $\rot\star$ sont les racines carrées de celles de $\rott\star$.
\item pour ne pas avoir de multiplicité > 1, on ne garde que les positives.
\item le signe est porté par le coefficient $c_k$.
\end{itemize}
\end{block}
\end{frame}

\section{Fonctions propres}
\begin{frame}{$\rott  g_i = \lambda_i^2 g_i$}
\begin{block}{Fonctions propres de $\rott\star$}
\begin{itemize}
\item Problème :
\[
\left\{
\begin{aligned}
&\rott  g_i = \lambda_i^2 g_i\\
&g_i\cdot n\restr = 0\\
&\rot g_i\cdot n\restr = 0\\
&\rott  g_i\cdot n\restr = 0
\end{aligned}
\right.
\]
\item Formulation variationnelle :
\[
\int_\Omega (\rot g)(\rot\varphi)\ dX = \lambda\int_\Omega g\varphi\ dX
\]
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Décomposition des fonctions propres}
\begin{block}{Décomposition des $g_i$}
\begin{center}
\begin{tabular}{c|ccccc}
& $g_i$ & = & $g_i^0$ & + & $\grad\psi_i$ \\ \hline
$\rott\star$ & $-\laplace g_i$ & & $\grad(\diverg g_i^0)-\laplace g_i^0$ & & 0\\ \hline
$\diverg\star$ & 0 & & $\diverg g_i^0$ & & $\laplace\psi_i$\\ \hline
$\star\cdot n\restr$ & 0 & & 0 & & 0
\end{tabular}
\end{center}
\end{block}
\begin{block}{$g_i=g_i^0+\grad\psi_i$}
\begin{itemize}
\item Problème :
\[
\left\{
\begin{aligned}
\grad(\diverg g_i^0)-\laplace g_i^0 &= -\laplace g_i\\
g_i^0\restr &= 0
\end{aligned}
\right.
\]
\item Formulation variationnelle :
\[
-\int_\Omega (\diverg g_i^0)(\diverg\varphi) + \int_\Omega \grad g_i^0\grad\varphi = \int_\Omega \grad g_i\grad\varphi
\]
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{Décomposition des fonctions propres}
\begin{block}{$g_i=g_i^0+\grad\psi_i$}
\begin{itemize}
\item Problème :
\[
\left\{
\begin{aligned}
-\laplace\psi_i &= \diverg g_i^0\\
\grad\psi_i\cdot n\restr &= 0
\end{aligned}
\right.
\]
\item Formulation variationnelle :
\[
\int_\Omega \grad\psi_i\grad\varphi = \int_\Omega (\diverg g_i^0)\varphi
\]
\end{itemize}
\end{block}
\end{frame}

\section{Problème spectral}
\begin{frame}{Problème spectral}
\begin{block}{Problème}
\[
\left\{
\begin{aligned}
&\frac{\partial u}{\partial t} + (\rot u)\times u + (\rot u)\times a + \left(\rot a\right)\times u \\
&+ \grad\pi_a + \frac{1}{Re}\rott u - h = 0\\
&\diverg u = 0\\
&u\cdot n\restr = 0\\
&(\rot u)\cdot n\restr = 0\\
&(\rott u)\cdot n\restr = \alpha_2
\end{aligned}
\right.
\]
\end{block}
\end{frame}

\begin{frame}{Problème spectral}
\begin{block}{Forme variationnelle}
\begin{align*}
\int_\Omega \frac{\partial u}{\partial t}\cdot \varphi &+ \int_\Omega ((\rot u)\times u)\cdot \varphi + \int_\Omega ((\rot u)\times a)\cdot\varphi \\
&+ \int_\Omega ((\rot a)\times u)\cdot\varphi + \frac{1}{Re}\int_\Omega (\rot u)\cdot(\rot\varphi) \\
&-\frac{1}{Re}\int_{\partial\Omega} \alpha_2\phi = \int_\Omega h\cdot\varphi
\end{align*}
\end{block}
\end{frame}

\begin{frame}{Problème spectral}
\begin{block}{Discrètisation}
\begin{align*}
\sum \frac{\partial c_i}{\partial t}(g_i,g_k) &+ \sum_i\sum_j c_i\lambda_i c_j(g_i\times g_j, g_k) \\
&+ \sum c_i\lambda_i(g_i\times a,g_k) + \sum c_i((\rot a)\times g_i, g_k) \\
&+ \frac{1}{Re}\sum c_i\lambda_i\lambda_k(g_i,g_k) = (h,g_k) + \frac{1}{Re}\langle\alpha_2,\psi_k\rangle
\end{align*}
Orthonormalisation de la base $(g_i)$ : $(g_i,g_k)=\delta_{ik}$
\begin{eqnarray*}
%\begin{aligned}
\frac{\partial c_k}{\partial t} + \sum_i\sum_j c_i\lambda_i c_j(g_i\times g_j, g_k) + \sum c_i\lambda_i(g_i\times a,g_k)\\
+ \sum c_i((\rot a)\times g_i, g_k) + \frac{1}{Re}c_k\lambda_k^2 = (h,g_k) + \frac{1}{Re}\langle\alpha_2,\psi_k\rangle
\end{eqnarray*}
\end{block}
\end{frame}

\section{Synthèse}
\begin{frame}{Organigramme}
\begin{figure}
\centering
\begin{tikzpicture}[scale=\taille]
\node[draw,scale=\taille,fill=green!50] (a0) at (0,0) {$\alpha_0$} ;
\node[draw,scale=\taille,fill=green!50] (a1) at (4,0) {$\alpha_1$} ;
\node[draw,scale=\taille,fill=gray!50] (pbpsi0) at (0,-2) 
{$\begin{aligned}
-\laplace\psi_0&=0\\
\grad\psi_0\cdot n\restr &= \alpha_0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=gray!50] (pbb) at (4,-3) 
{$\begin{aligned}
\rott b &= \grad\psi_0\\
\diverg b &=0\\ 
b\cdot n\restr &= 0\\
\rot b\cdot n\restr &= 0\\
\rott b\cdot n\restr &= \alpha_1
\end{aligned}$} ;
\node[draw,scale=\taille,fill=gray!50] (pbeigen) at (12,-3) 
{$\begin{aligned}
\rott g_i = \lambda_i^2g_i\\
g_i\cdot n\restr = 0\\
\rot g_i\cdot n\restr = 0\\
\rott g_i\cdot n\restr = 0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=blue!50] (psi0) at (0,-6) {$\grad\psi_0$} ;
\node[draw,scale=\taille,fill=blue!50] (b) at (4,-6) {$\rot b$} ;
\node[draw,scale=\taille,fill=yellow!50] (lambda) at (11,-6) {$\lambda_i$} ;
\node[draw,scale=\taille,fill=yellow!50] (gi) at (13,-6) {$g_i$} ;
\node[draw,scale=\taille,fill=gray!50] (pbgi0) at (16,-6) 
{$\begin{aligned}
\grad(\diverg_i^0)-\laplace g_i^0 = -\laplace g_i\\
g_i^0\restr = 0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=gray!50] (pba) at (2,-8) {$a = \rot b + \grad\psi_0$} ;
\node[draw,scale=\taille,fill=green!50] (f) at (7,-8) {$f$} ;
\node[draw,scale=\taille,fill=green!50] (a2) at (8,-8) {$\alpha_2$} ;
\node[draw,scale=\taille,fill=green!50] (ck0) at (9,-8) {$c_k^0$} ;
\node[draw,scale=\taille,fill=yellow!50] (gi0) at (16,-8) {$g_i^0$} ;
\node[draw,scale=\taille,fill=gray!50] (pbpsi) at (16,-10) 
{$\begin{aligned}
-\laplace\psi_i = \diverg g_i^0\\
\grad\psi_i\cdot n\restr = 0
\end{aligned}$} ;
\node[draw,scale=\taille,fill=yellow!50] (psi) at (16,-12) {$\psi_i$} ;
\node[draw,scale=\taillem,fill=blue!50] (a) at (2,-12) {$a$} ;
\node[draw,scale=\taille,fill=gray!50] (pbs) at (9,-12)
{$\begin{aligned}
\frac{\partial c_k}{\partial t} &+ \sum_i\sum_j c_i\lambda_i c_j(g_i\times g_j, g_k) \\
&+ \sum_i c_i\lambda_i(g_i\times a,g_k) + \sum_i c_i((\rot a)\times g_i, g_k) \\
&+ \frac{1}{Re}c_k\lambda_k^2 = (h,g_k) + \frac{1}{Re}\langle\alpha_2,\psi_k\rangle\\
&c_k(0)=c_k^0
\end{aligned}
$} ;
\node[draw,scale=\taille,fill=blue!50] (ck) at (9,-15) {$c_k$} ;
\node[draw,scale=\taille,fill=gray!50] (pbu) at (9,-16) {$u=\sum c_kg_k$} ;
\node[draw,scale=\taillem,fill=blue!50] (u) at (9,-17) {$u$} ;
\node[draw,scale=\taille,fill=gray!50] (pbv) at (4,-18) {$v=a+u$} ;
\node[draw,scale=\tailleg,fill=red!50] (v) at (4,-19) {$v$} ;
\node[draw,scale=\taille,fill=gray!50] (pbq) at (10,-19)
{$\begin{aligned}
-\laplace q = \diverg((\rot v)\times v) - \diverg f\\
\grad q\cdot n\restr =  f\cdot n\restr - \frac{\partial\alpha_0}{\partial t} - ((\rot v)\times v)\cdot n\restr - \frac{\alpha_2}{Re}
\end{aligned}$} ;
\node[draw,scale=\tailleg,fill=red!50] (q) at(16,-19) {$q$} ;

\draw[->,>=latex] (a0) -- (pbpsi0);
\draw[->,>=latex] (a1) -- (pbb);
\draw[->,>=latex] (pbpsi0) -- (psi0);
\draw[->,>=latex] (pbb) -- (b);
\draw[->,>=latex] (b) -- (pba);
\draw[->,>=latex] (psi0) -- (pba); 
\draw[->,>=latex] (pba) -- (a); 
\draw[->,>=latex] (pbeigen) -- (lambda);
\draw[->,>=latex] (pbeigen) -- (gi);
\draw[->,>=latex] (gi) -- (pbgi0);
\draw[->,>=latex] (pbgi0) -- (gi0);
\draw[->,>=latex] (gi0) -- (pbpsi);
\draw[->,>=latex] (pbpsi) -- (psi);
\draw[->,>=latex] (a) -- (pbs);
\draw[->,>=latex] (f) -- (pbs);
\draw[->,>=latex] (a2) -- (pbs);
\draw[->,>=latex] (ck0) -- (pbs);
\draw[->,>=latex] (lambda) -- (pbs);
\draw[->,>=latex] (gi) -- (pbs);
\draw[->,>=latex] (psi) -- (pbs);
\draw[->,>=latex] (pbs) -- (ck);
\draw[->,>=latex] (ck) -- (pbu);
\draw[->,>=latex] (pbu) -- (u);
\draw[->,>=latex] (u) -- (pbv);
\draw[->,>=latex] (a) -- (pbv);
\draw[->,>=latex] (pbv) -- (v);
\draw[->,>=latex] (v) -- (pbq);
\draw[->,>=latex] (pbq) -- (q);
\end{tikzpicture}
\caption{Organigramme de synthèse}
\label{org}
\end{figure}

\end{frame}

\end{document}
