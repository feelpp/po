\section{The condition $\curl \mbf{u}_h\cdot\mbf{n}=0$ on $\Gamma$}
Let $\Omega\subset\R^3$ be a bounded simply-connected domain with a
Lipschitz continuous boundary $\Gamma$. Let $\Gamma_0,\dots,\Gamma_I$
be the connected components of $\Gamma$.\\

We will use the following notations :
\begin{align*}
gradient(v)&=(\partial_x v, \partial_y v, \partial_z v)=\grad v\\
gradient(\mbf{v})&=\begin{pmatrix}
\partial_x v_x & \partial_y v_x & \partial_z v_x\\
\partial_x v_y & \partial_y v_y & \partial_z v_y\\
\partial_x v_z & \partial_y v_z & \partial_z v_z
\end{pmatrix}=\grad\mbf{v}\\
divergence(\mbf{v})&=\frac{\partial v_x}{\partial x}+\frac{\partial v_y}{\partial y}+\frac{\partial v_z}{\partial z}=\div \mbf{v}\\
rotationnel(\mbf{v})&=\begin{pmatrix}
\partial_y v_z - \partial_z v_y\\
\partial_z v_x - \partial_x v_z\\
\partial_x v_y - \partial_y v_x
\end{pmatrix}=\curl \mbf{v}\\
bcurl(curl(\mbf{v}))&=\curll \mbf{v}\\
H^1(\Omega) &= \{v \in L^2(\Omega)\;|\; \grad v\in L^2(\Omega)\}\\
H^1_0(\Omega) &= \{v \in H^1(\Omega)\; |\; v\restr{\Gamma} = 0\}\\
H(\mathrm{div};\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \div\mbf{v} \in L^2(\Omega) \}\\
H(\mathrm{curl};\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \curl\mbf{v} \in L^2(\Omega) \}\\
L^2_\sigma(\Omega) &= \{\mbf{v} \in [L^2(\Omega)]^3\; |\; \div \mbf{v} = 0\text{ et }\mbf{v}\cdot \mbf{n}\restr{\Gamma} = 0 \}\\
D^1(\Omega) &= \{\mbf{v} \in [H^1(\Omega)]^3\cap L^2_\sigma(\Omega)\; |\; (\curl \mbf{v}\cdot \mbf{n})\restr{\Gamma} = 0  \}
\end{align*}

\subsection{Problem}
We consider the following problem :
\begin{pb}\label{pbstart}
Find $\lambda\in\CC$ and $\mbf{u}\ne 0$ such that
\begin{align}
\curl\mbf{u} = \lambda\mbf{u} & \quad \mbox{in }\Omega\\
\div\mbf{u} = 0 & \quad \mbox{in }\Omega\\
\mbf{u}\cdot \mbf{n} = 0 & \quad \mbox{on }\Gamma
\end{align}
\end{pb}

According to R. Rodriguez and P. Venegas in \cite{Venegas2013}, this problem, for $\lambda\ne 0$, is
equivalent to :
\begin{pb}\label{pbcond}
Find $\lambda\in\CC$ and $\mbf{u}\in
  H(\mathrm{curl};\Omega),\mbf{u}\ne 0$ such that
\begin{align}
\curl \mbf{u} = \lambda \mbf{u} & \quad \mbox{in }\Omega\\
\curl \mbf{u}\cdot\mbf{n} = 0 & \quad \mbox{on }\Gamma
\end{align}
\end{pb}
The solution of this problem belongs to $\ZZ=\{\mbf{v}\in
H(\mathrm{curl};\Omega \,|\, \curl\mbf{v}\cdot\mbf{n}=0 \mbox{
  on } \Gamma \}$.\\

Next, we multiply by $\mbf{v}\in\ZZ$ and integrate :
\[ \int_\Omega \curl\mbf{u}\cdot\mbf{v} = \lambda\int_\Omega
\mbf{u}\cdot\mbf{v} \]
We have the follwing property for all $\mbf{u},\mbf{v}\in\ZZ$ :
\[ \int_\Omega \left(\curl\mbf{u}\right)\cdot\mbf{v} -
\mbf{u}\cdot\left(\curl\mbf{v}\right) = 0 \]
Then, by applying it twice and using
$\curl\mbf{u}=\lambda\mbf{u}$, we obtain the following
variationnal form of the Problem \ref{pbstart} :
\begin{pb}\label{pbweak}
Find $\lambda\in\CC$ and $\mbf{u}\in\ZZ$, $\mbf{u}\ne 0$, such
that
\[ \int_\Omega \curl\mbf{u}\cdot\curl\mbf{v} =
\lambda^2\int_\Omega \mbf{u}\cdot\mbf{v} \quad \forall
\mbf{v}\in\ZZ \]
\end{pb}

If $(\lambda,\mbf{u})$ is a solution of Problem \ref{pbstart}, then it is a
solution of Problem \ref{pbweak}. But the contrary is not always true,
see \cite{Venegas2013} Corollary 3.10 :\\

If $\nu\ne 0$ is a solution of Problem \ref{pbweak} and $\bm{\mathcal{E}}$ the
corresponding eigenspace, then there exists an eigenvalue $\lambda$ of
Problem \ref{pbstart} such that $\nu=\lambda^2$ and $\bm{\mathcal{E}}$ is an
invariant subspace of Problem \ref{pbstart}.\\

In fact, the eigenfunctions of Problem \ref{pbweak} are not necessarily
eigenfunctions of Problem \ref{pbstart}. If both $\lambda$ and $-\lambda$
are eigenvalues of Problem \ref{pbstart}, the $\lambda^2$ is an eigenvalue
of Problem \ref{pbweak} with multiplicity equal to the sum of those of
$\lambda$ and $-\lambda$. And the eigenfunction of Problem \ref{pbweak}
corresponding to $\lambda^2$ would be a linear combination of the
eigenfunctions of Problem \ref{pbstart} associated to $\lambda$ and
$-\lambda$.\\

\begin{rk}
In our case, we are mainly interested by the eigenspace, since the
eigen functions span the space $D^1(\Omega)$. We use the fact that
$\curl\mbf{u}=\lambda\mbf{u}$ but it is a convenience, we could
also compute $\curl\mbf{u}$.
\end{rk}

\subsection{Discretization}
From now on, we'll use the following notations :
\begin{align*}
&\TT_h\mbox{ the set of tetrahedra } T \mbox{ such that }
\mbox{ such that } \Omega=\cup_{T\in\TT}T\\
&\TT_h^\Gamma =\{F\mbox{ faces of } T\in \TT_h \,|\, F\subset \Gamma
\}\\
&\NN^k(T)=\PP_{k-1}(T)^3\oplus\{\mbf{p}\in\PP_k(T)^3 \,|\,
\mbf{p(x)}\cdot\mbf{x}=0 \}\\
&\NN_h=\{\mbf{v}_h\in H(\mathrm{curl};\Omega) \,|\,
\mbf{v}_h\restr{T}\in\NN^k(T)\, \forall T\in \TT_h \}\\
&\ZZ_h=\NN_h\cap\ZZ=\{\mbf{v}_h\in\NN_h \,|\,
\curl\mbf{v}_h\cdot\mbf{n} = 0 \}
\end{align*}

The Galerkin approximation of Problem \ref{pbweak} reads :
\begin{pb}\label{pbdiscr}
Find $\lambda_h\in\CC$ and $\mbf{u}_h\in\ZZ_h$, $\mbf{u}_h\ne
0$, such that
\[\int_\Omega \curl\mbf{u}_h\cdot\curl\mbf{v}_h =
\lambda_h^2\int_\Omega \mbf{u}_h\cdot\mbf{v}_h \quad\quad
\forall\mbf{v}_h\in\ZZ_h \]
\end{pb}

The issue is to impose the condition
$\curl\mbf{u}_h\cdot\mbf{n}=0$ on $\Gamma$. Before, we tried to apply this
condition by a penalization method. But this was difficult, because we had to
find the proper parameter.\\

\subsubsection{A new basis}
\label{base}
In \cite{Venegas2013}, following the method used in
\cite{Meddahi2003,Salgado2005}, they propose a basis to the space $\ZZ_h$.
Since it is based on the work of A. Buffa in \cite{Buffa2002845}, we need to
define some operators before we go on.
\begin{align*}
\pi_\tau(u) &= \mbf{n}\times\mbf{u}\times\mbf{n}\restr{\Gamma} &\mbox{the projection on
  the tangential plane}\\
\gamma_\tau(u) &= \mbf{u}\times\mbf{n}\restr{\Gamma} &\mbox{the tangential
  trace}\\
\grad_\Gamma(\varphi) &= \pi_\tau(\grad\varphi) &\mbox{the tangential gradient}\\
\mathrm{curl}_\Gamma(\varphi) &= \gamma_\tau(\grad\varphi) &\mbox{the tangential curl}
\end{align*}

Then, we have the equivalence :
\[ \curl\mbf{u}_h\cdot\mbf{n}=0\mbox{ on }\Gamma \iff
\mathrm{curl}_\Gamma(\pi_\tau(\mbf{u}_h))=0\quad \mbox{ on } \Gamma \]
and since $\mathrm{Ker(curl}_\Gamma)=\grad_\Gamma H^1(\Gamma)$ we have 
\[ \curl\mbf{u}_h\cdot\mbf{n}=0\mbox{ on }\Gamma \iff
\exists\varphi_h\in H^1(\Gamma) \mbox{ such that
}\mbf{n}\times\mbf{u}_h\times\mbf{n} = \grad_\Gamma\varphi_h \]
In fact, by \cite{Monk2003} Remark 5.29, we know that 
\[\varphi_h\in\LLL_h^\Gamma = \{\psi_h\in\mathcal{C}(\Gamma) \,|\,
\psi_h\restr{\Gamma}\in\PP_k(F) \quad \forall F\in\TT_h^\Gamma \}\]
the set of continuous functions which are piecewise polynomial on the faces of
the boundary.\\

The idea for creating the basis of $\ZZ_h$ is to take the basis of $\NN_h$, keep
only the functions define on the internal elements of the mesh and replace the
elements of the boundary by a basis of $\LLL_h^\Gamma$.\\

Let \[ \LLL_h=\{\psi\in\mathcal{C}(\Omega) \,|\,
\phi\restr{T}\in\PP_k(T)\,\forall T\in\TT_h^\} \]
and $\{\varphi_j\}_{j=1}^K$ be the nodal basis of $\LLL_h$.\\
We assume that the first J of them correspond to all the nodal values on the
boundary $\Gamma$. Then $\{\varphi_j\restr{\Gamma}\}_{j=1}^J$ is a
basis of $\LLL_h^\Gamma$ and
$\left\langle\{\grad_\Gamma\varphi_j\}_{j=1}^J\right\rangle=\grad_\Gamma(\LLL_h^\Gamma)$.\\
In order to have a basis, we have to choose one vertex on each connected
compoenent $\Gamma_0,\dots,\Gamma_I$ and remove the basis functions
corresponding. Assume that those functions are the last ones, then if
$L=J-(I+1)$, $\{\grad_\Gamma\varphi_j\}_{j=1}^L$ is a basis of
$\grad_\Gamma(\LLL_h^\Gamma)$.\\
Let $\{\bm{\phi}_m\}_{m=1}^M$ be the basis of $\NN_h$, where the last ones
correspond to the degrees of freedom related to the faces or edges on
$\Gamma$. We have that $\{\bm{\phi}_m\}_{m=1}^N$ lie in $\ZZ_h$.\\

Then the set $\{\bm{\phi}_m\}_{m=1}^N\cup  \{\grad_\Gamma\varphi_j\}_{j=1}^L$
is a basis of $\ZZ_h$.

\subsubsection{An algebraic solution}
In the case of the lowest order Nedelec elements, there is a way to impose the
condition $\curl\mbf{u}_h\cdot\mbf{n}=0$ without computing the basis seen in
  \ref{base}.\\
In the case of the lowest order, the degrees of freedom of the Nedelec elements
are \[\alpha_m=\int_{e_m} \mbf{u}_h\cdot\mbf{t}_m \quad m=1,\dots,M\] where $\{e_1,\dots,e_M\}$ is the set
of all edges in $\TT_h$ and $\mbf{t}_m$ is a unit vector tangent to $e_m$. The
direction of this vector depends on ...\\
Then we have \[\mbf{u}_h = \sum_{m=1}^M \alpha_m\bm{\phi}_m\]

Let $\{P_j\}_{j=1}^J$ be the set of vertices of $\TT_h^\Gamma$, and
$\{\varphi_j\}_{j=1}^J$ be the basis of $\LLL_h^\Gamma$, where the last $I$
functions are choses on a different connected component of $\Gamma$. Then, we have also :
\[ \mbf{u}_h = \sum_{m=1}^N \alpha_m'\bm{\phi}_m + \sum_{j=1}^L
\beta_j\grad_\Gamma\varphi_j \]
By identification, we obtain :
\[
\alpha_m=\left\{\begin{aligned}
&\alpha_m', &&\mbox{if } e_m\cap\Gamma = \emptyset, &\texttt{internalelements}\\
&\alpha_m'\pm \beta_j, &&\mbox{if } e_m\cap\Gamma = \{P_j\},& \texttt{boundaryelements}\backslash\texttt{boundaryedges}\\
&\alpha_m'\pm (\beta_j-\beta_k), &&\mbox{if } e_m\cap\Gamma = \{P_j,P_k\}
(e_m\notin\Gamma),& \texttt{boundaryelements}\backslash\texttt{boundaryedges}\\
&\pm (\beta_j-\beta_k), &&\mbox{if } e_m=[P_j,P_k]\subset\Gamma & \texttt{boundaryedges}
\end{aligned}\right.
\]
the signs depend on the direction of $t_m$.\\

We note $\bm{\alpha}=(\alpha_1,\dots,\alpha_M)^t$ and
$\widehat{\bm{\alpha}}=(\alpha_1',\dots,\alpha_M',\beta_1,\dots,\beta_J)^t$ and
then we can define a matrix $\mbf{C}\in\R^{M\times(N+L)}$ such that $\bm{\alpha}=\mbf{C}\widehat{\bm{\alpha}}$.\\

Let $\mbf{A}=(A_{ij})$ and $\mbf{B}=(B_{ij})$ be the $M\times M$ matrices defined
by 
\[A_{ij}=\int_\Omega \curl\bm{\phi}_j\cdot\curl\bm{\phi}_i \quad\mbox{and}\quad
B_{ij}=\int_\Omega\bm{\phi}_j\cdot\bm{\phi}_i\quad i,j=1,\dots,M \]
Then, by changing the basis, we have the following matrix form of Problem
\ref{pbdiscr} :
\begin{pb}\label{pbmat}
Find $\lambda_h\in\R$ and $\widehat{\bm{\alpha}}\in\R^{N+L}$ such that
\[ \widehat{\mbf{A}}\widehat{\bm{\alpha}} =
\lambda_h^2\widehat{\mbf{B}}\widehat{\bm{\alpha}} \]
where $\widehat{\mbf{A}}=\mbf{C}^t\mbf{A}\mbf{C}$ and $\widehat{\mbf{B}}=\mbf{C}^t\mbf{B}\mbf{C}$
\end{pb}

\subsubsection{Example}
If we take for an element the following tetrahedron :
\begin{figure}[H]
\centering
\begin{tikzpicture}[line join = round, line cap = round]
\coordinate [label=left:$a_0$] (A) at (0,0,0);
\coordinate [label=below:$a_1$] (D) at (0,0,3);
\coordinate [label=right:$a_2$] (B) at (3,0,0);
\coordinate [label=above:$a_3$] (C) at (0,3,0);
\foreach \i in {A,B,C,D}
    \draw[dashed] (0,0)--(\i);
\draw[-] (A)--(D)--(B)--cycle;
\draw[-] (A) --(D)--(C)--cycle;
\draw[-] (B)--(D)--(C)--cycle;

\draw[->] (-4,0) -- (-4,0,1) node[below left] {$x$};
\draw[->] (-4,0) -- (-3,0,0) node[right] {$y$};
\draw[->] (-4,0) -- (-4,1,0) node[above] {$z$};
\end{tikzpicture}
\end{figure}
with
\begin{align*}
a_0 &= (-1,-1,-1) & a_1 &= (1,-1,-1)\\
a_2 &= (-1,1,-1) & a_3 &= (-1,-1,1)
\end{align*}
\begin{align*}
e_0 &= [a_3,a_0] & e_1 &= [a_3,a_1] & e_2 &= [a_3,a_2]\\
e_3 &= [a_2,a_0] & e_4 &= [a_0,a_1] & e_5 &= [a_1,a_2]
\end{align*}

The tangent are then :
\[ \mbf{t}_0=\begin{pmatrix}0\\0\\1\end{pmatrix}\;
\mbf{t}_1=\begin{pmatrix}-1\\0\\1\end{pmatrix}\;
\mbf{t}_2=\begin{pmatrix}0\\-1\\1\end{pmatrix}\;
\mbf{t}_3=\begin{pmatrix}0\\-1\\0\end{pmatrix}\;
\mbf{t}_4=\begin{pmatrix}1\\0\\0\end{pmatrix}\;
\mbf{t}_5=\begin{pmatrix}-1\\1\\0\end{pmatrix}\;
\]
And the degrees of freedom are :
\begin{gather*}
\sigma_0(\mbf{u}) = \int_{e_0} \mbf{t}_0\cdot\mbf{u} =
\int_{x_1=-1}\int_{x_2=-1}\int_{x_3=-1}^1 (0,0,1)^T\cdot\mbf{u}\\
\sigma_1(\mbf{u}) = \int_{e_1} \mbf{t}_1\cdot\mbf{u} =
\int_{x_1=-1}^1\int_{x_2=-1}\int_{x_3=-x_1} (-1,0,1)^T\cdot\mbf{u}\\
\sigma_2(\mbf{u}) = \int_{e_2} \mbf{t}_2\cdot\mbf{u} =
\int_{x_1=-1}\int_{x_2=-1}^1\int_{x_3=-x_2} (0,-1,1)^T\cdot\mbf{u}\\
\sigma_3(\mbf{u}) = \int_{e_3} \mbf{t}_3\cdot\mbf{u} =
\int_{x_1=-1}\int_{x_2=-1}^1\int_{x_3=-1} (0,-1,0)^T\cdot\mbf{u}\\
\sigma_4(\mbf{u}) = \int_{e_4} \mbf{t}_4\cdot\mbf{u} =
\int_{x_1=-1}^1\int_{x_2=-1}\int_{x_3=-1} (1,0,0)^T\cdot\mbf{u}\\
\sigma_5(\mbf{u}) = \int_{e_5} \mbf{t}_5\cdot\mbf{u} =
\int_{x_1=-1}^1\int_{x_2=-x_1}\int_{x_3=-1} (-1,1,0)^T\cdot\mbf{u}
\end{gather*}
To determine the basis $\{\bm{\phi}_i\}_{i=0}^5$ of $\NN_h$ we use the fact that
$\sigma_i(\bm{\phi}_j) = \delta_{ij}$, and we find that :
\begin{align*}
\bm{\phi}_0 &= \frac{1}{4}\begin{pmatrix}1+x_3\\1+x_3\\-x_1-x_2\end{pmatrix} &
\bm{\phi}_1 &= \frac{1}{4}\begin{pmatrix}-1-x_3\\0\\1+x_1\end{pmatrix} \\
\bm{\phi}_2 &= \frac{1}{4}\begin{pmatrix}0\\-1-x_3\\1+x_2\end{pmatrix} &
\bm{\phi}_3 &= \frac{1}{4}\begin{pmatrix}-1-x_2\\x_1+x_3\\-1-x_2\end{pmatrix}\\
\bm{\phi}_4 &= \frac{1}{4}\begin{pmatrix}-x_2-x_3\\1+x_1\\1+x_1\end{pmatrix} &
\bm{\phi}_5 &= \frac{1}{4}\begin{pmatrix}-1-x_2\\1+x_1\\0\end{pmatrix}
\end{align*}

If we assume that $\Gamma=\{z=0\}$, then $N=2$ and $J=2$.

Then we have that $\{\varphi_j\}_{j=0}^3$ is a basis of $\LLL_h$, with :
\begin{align*}
\varphi_0(x,y,z) &= \frac{-1}{8}(4+4x+4y+4z) &
\varphi_1(x,y,z) &= \frac{x+1}{2}\\
\varphi_2(x,y,z) &= \frac{y+1}{2} & \varphi_3(x,y,z) &= \frac{z+1}{2}\\
\end{align*}
Then $\left\langle\{\varphi_j\}_{j=0}^2\right\rangle=\LLL_h^\Gamma$ and
$n=(0,0,-1)$, which leads to :
\[
\grad_\Gamma \varphi_0(x,y,z) = \begin{pmatrix}-1/2\\1/2\\0\end{pmatrix},\quad
\grad_\Gamma \varphi_1(x,y,z) = \begin{pmatrix}1/2\\0\\0\end{pmatrix},\quad
\grad_\Gamma \varphi_2(x,y,z) = \begin{pmatrix}0\\1/2\\0\end{pmatrix}
\]
We have to remove a function corresponding to the only connected component of
$\Gamma$, so we remove $\grad_\Gamma \varphi_2$.\\
Then $\{\grad_\Gamma \varphi_j\}_{j=0}^1$ is a basis of
$\grad_\Gamma(\LLL_h^\Gamma)$.\\

We finally have \[ \{\bm{\phi}_m\}_{m=0}^2\cup\{\grad_\Gamma\varphi_j\}_{j=0}^1
\mbox{ is a basis of } \ZZ_h \]
And
\begin{align*}
\mbf{u}_h &= \sum_{m=0}^5 \sigma_m(\mbf{u}_h) \bm{\phi}_m = \sum_{m=1}^6 \alpha_m \bm{\phi}_m\\
&= \sum_{m=0}^2 \alpha_m'\bm{\phi}_m + \sum_{j=0}^2 \beta_j\grad_\Gamma\varphi_j
\end{align*}
with $\beta_2 = 0$.\\

We also have the following relations :
\begin{align*}
\alpha_0 &= \alpha_0' \pm \beta_0\\
\alpha_1 &= \alpha_1' \pm \beta_1\\
\alpha_2 &= \alpha_2' \pm \beta_2\\
\alpha_3 &= \pm(\beta_0-\beta_2)\\
\alpha_4 &= \pm(\beta_0-\beta_1)\\
\alpha_5 &= \pm(\beta_1-\beta_2)
\end{align*}
Which leads to the system :
\[ \begin{pmatrix}
\alpha_0\\\alpha_1\\\alpha_2\\\alpha_3\\\alpha_4\\\alpha_5
\end{pmatrix} = \begin{pmatrix}
1 & 0 & 0 & \pm 1 & 0 & 0\\
0 & 1 & 0 & 0 & \pm 1 & 0\\
0 & 0 & 1 & 0 & 0 & \pm 1\\
0 & 0 & 0 & \pm 1 & 0 & \mp 1\\
0 & 0 & 0 & \pm 1 & \mp 1 & 0\\
0 & 0 & 0 & 0 & \pm 1 & \mp 1\\
\end{pmatrix} \begin{pmatrix}
\alpha_0'\\\alpha_1'\\\alpha_2'\\\beta_0\\\beta_1\\\beta_2
\end{pmatrix} \]
Then
\begin{gather*} \widehat{A}=\begin{pmatrix}
1 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0\\
\pm 1 & 0 & 0 & \pm 1 & \pm 1 & 0\\
0 & \pm 1 & 0 & 0 & \pm 1 & \pm 1\\
0 & 0 & \pm 1 & \pm 1 & \pm 1 & 0
\end{pmatrix}\begin{pmatrix}
a_{00} & a_{01} & a_{02} & a_{03} & a_{04} & a_{05}\\
a_{10} & a_{11} & a_{12} & a_{13} & a_{14} & a_{15}\\
a_{20} & a_{21} & a_{22} & a_{23} & a_{24} & a_{25}\\
a_{30} & a_{31} & a_{32} & a_{33} & a_{34} & a_{35}\\
a_{40} & a_{41} & a_{42} & a_{43} & a_{44} & a_{45}\\
a_{50} & a_{51} & a_{52} & a_{53} & a_{54} & a_{55}\\
\end{pmatrix}\begin{pmatrix}
1 & 0 & 0 & \pm 1 & 0 & 0\\
0 & 1 & 0 & 0 & \pm 1 & 0\\
0 & 0 & 1 & 0 & 0 & \pm 1\\
0 & 0 & 0 & \pm 1 & 0 & \mp 1\\
0 & 0 & 0 & \pm 1 & \mp 1 & 0\\
0 & 0 & 0 & 0 & \pm 1 & \mp 1\\
\end{pmatrix}\\
\widehat{B}=\begin{pmatrix}
1 & 0 & 0 & 0 & 0 & 0\\
0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0\\
\pm 1 & 0 & 0 & \pm 1 & \pm 1 & 0\\
0 & \pm 1 & 0 & 0 & \pm 1 & \pm 1\\
0 & 0 & \pm 1 & \pm 1 & \pm 1 & 0
\end{pmatrix}\begin{pmatrix}
b_{00} & b_{01} & b_{02} & b_{03} & b_{04} & b_{05}\\
b_{10} & b_{11} & b_{12} & b_{13} & b_{14} & b_{15}\\
b_{20} & b_{21} & b_{22} & b_{23} & b_{24} & b_{25}\\
b_{30} & b_{31} & b_{32} & b_{33} & b_{34} & b_{35}\\
b_{40} & b_{41} & b_{42} & b_{43} & b_{44} & b_{45}\\
b_{50} & b_{51} & b_{52} & b_{53} & b_{54} & b_{55}\\
\end{pmatrix}\begin{pmatrix}
1 & 0 & 0 & \pm 1 & 0 & 0\\
0 & 1 & 0 & 0 & \pm 1 & 0\\
0 & 0 & 1 & 0 & 0 & \pm 1\\
0 & 0 & 0 & \pm 1 & 0 & \mp 1\\
0 & 0 & 0 & \pm 1 & \mp 1 & 0\\
0 & 0 & 0 & 0 & \pm 1 & \mp 1\\
\end{pmatrix}
\end{gather*}
with 
\begin{align*}
a_{ij} &= \int_\Omega \curl\bm{\phi}_i\cdot\curl\bm{\phi}_j &
b_{ij} &= \int_\Omega \bm{\phi}_i\cdot\bm{\phi}_j
\end{align*}


%%% Local Variables:
%%% TeX-master: "../peps.tex"
%%% eval: (flyspell-mode 1)
%%% ispell-local-dictionary: "english"
%%% End:
